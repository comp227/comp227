<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.d7e1cd9ed891169c08e7.css">@import url(https://fonts.googleapis.com/css2?family=Alegreya:wght@300;600&display=swap);@import url(https://fonts.googleapis.com/css?family=Alegreya+Sans:400);@import url(https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300);@import url(https://fonts.googleapis.com/css?family=Gelasio:400);@import url(https://fonts.googleapis.com/css2?family=Fira+Code&display=swap);code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.course{position:relative;width:100%}@media (min-width:992px){.course{display:flex;flex-wrap:nowrap;flex-direction:row;align-items:flex-start}}.course p{font-family:Noto Sans,monospace}html[data-theme=light] .course p{font-family:Gelasio,monospace}@media (min-width:640px){.course p{margin-left:1rem}}.course p:not(:last-of-type){margin-bottom:1rem}@media (min-width:640px){.course h1{margin-left:3rem}}.course h2,.course h3,.course h4{padding-bottom:2rem}@media (min-width:640px){.course h2,.course h3,.course h4{margin-left:1rem}}.course table{font-family:Noto Sans,monospace}html[data-theme=light] .course table{font-family:Gelasio,monospace}@media (min-width:640px){.course table{margin-left:1rem}}.course ol,.course ul{font-family:Noto Sans,monospace}html[data-theme=light] .course ol,html[data-theme=light] .course ul{font-family:Gelasio,monospace}@media (min-width:640px){.course ol,.course ul{margin-left:2.2rem}}html[data-theme=light] .course a{font-family:Gelasio,monospace}.course h2:not(:first-of-type){margin-top:2rem}.course pre{margin-left:1rem;background-color:var(--color-pre-background);color:#fff}.course code.language-text{background-color:rgba(var(--color-main),.6);color:rgba(var(--color-main),.6);font-family:Fira Code,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;font-weight:regular;padding:0}.course img{margin-left:1rem;border:0 solid transparent}.course .banner,.course .container{position:static}.course blockquote{border-left:2px;border-left-style:solid;border-left-color:#a0a0a0;padding-left:.5rem}html[data-theme=light] .course blockquote{background-color:#eaeaea}html[data-theme=dark] .course blockquote{background-color:#3f3d3e}.course .letter{width:4rem;height:4rem;border-width:5px;border-style:solid;border-radius:2.5rem;text-align:center;margin:1rem;line-height:1.3em;transform:translate(-1rem)}@media (min-width:640px){.course .letter{transform:translate(-3rem,4.5rem)}}.course .letter,.course h1{font-size:2.3rem;font-weight:700}.course-content-container{width:100%}.course-content a,.tasks a{border:0;border-bottom-width:3px;border-style:solid;padding:1px;display:inline-block;height:1.45rem}.course-content a:hover,.tasks a:hover{color:#212322}.course-content{width:90%;margin:0 auto;max-width:1200px}@media (min-width:992px){.course-content-inner{padding-left:30%;padding-right:5%}}.tasks a{border-color:var(--color-text)!important}.tasks a:hover{background-color:#fff!important;color:#000!important}.gatsby-highlight-code-line{display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:1em}html[data-theme=dark] .gatsby-highlight-code-line{background-color:#291e2a}html[data-theme=light] .gatsby-highlight-code-line{background-color:#3d2c3e}code[class*=language-],pre[class*=language-]{text-shadow:none}.arrow-go-up{width:36px;height:36px;position:fixed;bottom:5%;right:5%;z-index:40;cursor:pointer}html[data-theme=dark] .arrow-go-up{-webkit-filter:invert(1);filter:invert(1)}@media (max-width:639px){.arrow-go-up{right:10%}}.part-main__banner{background-position:50%;background-size:50%;padding-bottom:10%;background-repeat:no-repeat}@media (max-width:639px){.part-main__banner{background-position:top;background-size:70%;padding-bottom:30%!important}}.part-intro{font-family:Noto Sans,monospace!important}.part-intro li,.part-intro ol,.part-intro p,.part-intro ul{color:#212322}.part-intro p:not(:last-of-type){padding-bottom:2em}.part-intro__banner{background-size:50%;background-repeat:no-repeat;background-position:100%}@media (max-width:639px){.part-intro__banner{background-position:top;background-size:70%}.part-intro__banner>.container{margin-top:40%}}.part-intro a{color:#212322;border-bottom:1px solid #212322}.part-intro a:hover{background-color:#fff}.arrow__container{position:relative}.arrow__container:not():first-child{background:none;background-color:none}@media (min-width:640px){.arrow__container:not():first-child{border-left:none}.arrow__container:not():first-child:before{content:"";background:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjwhLS1HZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCktLT48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA0NzcuMTc1IDQ3Ny4xNzUiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQ3Ny4xNzUgNDc3LjE3NSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PHBhdGggZD0iTTM2MC43MzEsMjI5LjA3NWwtMjI1LjEtMjI1LjFjLTUuMy01LjMtMTMuOC01LjMtMTkuMSwwcy01LjMsMTMuOCwwLDE5LjFsMjE1LjUsMjE1LjVsLTIxNS41LDIxNS41CgkJYy01LjMsNS4zLTUuMywxMy44LDAsMTkuMWMyLjYsMi42LDYuMSw0LDkuNSw0YzMuNCwwLDYuOS0xLjMsOS41LTRsMjI1LjEtMjI1LjFDMzY1LjkzMSwyNDIuODc1LDM2NS45MzEsMjM0LjI3NSwzNjAuNzMxLDIyOS4wNzV6CgkJIi8+PC9nPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjwvc3ZnPg==) no-repeat;background-size:contain;position:absolute;top:0;left:0;height:100%;width:100%}}.arrows--horizontal{display:flex;position:relative;margin:0;align-items:flex-start}.arrow__wrapper{display:flex;justify-content:flex-start;align-items:center;margin:0}.arrow__wrapper:first-of-type{border-right:none;z-index:20}.arrow__wrapper:nth-of-type(n+2){margin-left:-4rem;z-index:10}.arrow__wrapper:nth-of-type(n+2) .arrow__rectangle{border-left:none;padding-left:4rem}.arrow__wrapper:nth-of-type(3){z-index:5}.arrow__wrapper:hover .arrow__point,.arrow__wrapper:hover .arrow__rectangle,.arrow__wrapper:hover .arrow__rectangle>a{background-color:#212322!important;color:#fff!important}.arrow__rectangle{padding:1rem;justify-content:center;align-items:center;border:2px solid #212322;border-right:none;z-index:2;overflow:hidden;font-family:Noto Sans,monospace;position:relative}.arrow__rectangle a{color:#212322}@media (max-width:991px){.arrow__rectangle{font-size:1rem}}.arrow__rectangle .bold{font-weight:600}.arrow__rectangle--thick-border{border:3px solid #212322;border-right:none}.arrow__point{padding:1.25rem;border:2px solid #212322;border-bottom:none;border-left:none;transform:translate(-1.3rem) rotate(45deg);z-index:1;overflow:hidden}.arrow__point--thick-border{border:3px solid #212322;border-bottom:none;border-left:none}.arrow__wrapper--stacked{display:flex;justify-content:flex-start;align-items:center;margin:auto auto auto 0}@media (max-width:639px){.arrow__wrapper--stacked .arrow__rectangle{border:none;background-color:transparent!important;padding:0;font-size:1rem;justify-content:unset}.arrow__wrapper--stacked .arrow__rectangle>p>span{border-bottom:1px solid #212322;margin:auto}.arrow__wrapper--stacked .arrow__rectangle>p>span:hover{background-color:#fff!important;color:#000}.arrow__wrapper--stacked .arrow__point{display:none}}.arrow__wrapper--stacked:nth-of-type(n+2){margin-top:1rem}@media (min-width:640px){.arrow__wrapper--stacked:nth-of-type(n+2){margin-top:-2px}}.arrow__wrapper--stacked .arrow__rectangle{position:relative}@media (min-width:640px){.arrow__wrapper--stacked .arrow__rectangle{padding:1.25rem}}@media (min-width:992px){.arrow__wrapper--stacked .arrow__rectangle{padding:1rem}}.arrow__wrapper--stacked .arrow__point{padding:1.08rem;margin-left:2px}@media (min-width:640px){.arrow__wrapper--stacked .arrow__point{margin-left:unset;padding:1.25rem}}@media (min-width:640px){.arrow__wrapper--stacked:hover .arrow__point,.arrow__wrapper--stacked:hover .arrow__rectangle{background-color:#212322!important}}@media (min-width:640px){.arrow__wrapper--stacked:hover .arrow--stacked-letter,.arrow__wrapper--stacked:hover .arrow--stacked-title{color:#fff}}.arrow--stacked-title{font-family:Alegreya,monospace;color:#212322}@media (min-width:640px){.arrow--stacked-title{white-space:nowrap}}.arrow__container--with-link{width:100%!important}@media (max-width:639px){.breadcrumb .arrow__wrapper{display:none}}.breadcrumb .arrow__wrapper:hover .arrow__point,.breadcrumb .arrow__wrapper:hover .arrow__rectangle{background-color:#212322!important}.breadcrumb .arrow__wrapper:hover .arrow--stacked-letter,.breadcrumb .arrow__wrapper:hover .arrow--stacked-title{color:#fff}.breadcrumb .arrow__rectangle{position:relative}@media (max-width:639px){.breadcrumb .arrow__rectangle{border:none;padding:0;font-size:.7rem;white-space:nowrap;background-color:transparent!important;color:#212322}}@media (max-width:639px){.breadcrumb .arrow__point{display:none}}.accordion__container{margin-bottom:1rem}.accordion__title{padding-left:2.149rem!important;padding-right:2.149rem!important;font-size:1.111rem!important;font-weight:600}.accordion{background-color:var(--color-background);border:3px solid var(--color-text);border-radius:5px;color:var(--color-text);cursor:pointer;padding:1rem;width:100%;text-align:left;outline:none;font-size:15px;transition:max-width .4s}.accordion:focus,.accordion:hover,.active{background-color:var(--color-main)}.active:focus{border:3px solid var(--color-text)}.accordion:after{content:"+";font-size:1.5rem;float:right;margin-left:5px}.active,.active:not(:focus-visible){border-color:var(--color-background)}.active:after{content:"-";font-size:1.5rem}.panel{background-color:var(--color-background);padding:2rem 18px}.accordion--side-navigation{width:100%;margin-left:unset}.accordion--side-navigation .accordion{border:none;padding:0!important;background-color:transparent!important;color:var(--color-text)!important;border-radius:0}.accordion--side-navigation .accordion__title{font-size:16px!important;font-weight:unset;background-color:transparent}.accordion--side-navigation .accordion__title:hover{background-color:var(--color-text)!important;color:var(--color-background)!important}.accordion--side-navigation .panel{padding:1rem 0 0!important;background-color:transparent!important;color:var(--color-text)!important}.accordion--side-navigation .panel ul{margin-left:1rem}.accordion--side-navigation .accordion:hover,.accordion--side-navigation .active,.accordion--side-navigation .panel:hover{background-color:var(--color-text);color:var(--color-background)}.accordion--side-navigation .accordion:after,.accordion--side-navigation .active:after,.accordion--side-navigation .panel:after{content:""}html{font-family:Alegreya Sans,monospace;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:Alegreya Sans,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em Alegreya Sans,monospace;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:hsla(var(--color-text-hsl),.8);font-family:Alegreya Sans,monospace;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1,h2{margin:0 0 1.45rem;font-size:2.25rem}h1,h2,h3{padding:0;color:inherit;font-family:Alegreya,monospace;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h3{margin:2rem 0 -.5rem;font-size:1.75rem}h4{padding:0;margin:2rem 0 -1rem;color:inherit;font-family:Alegreya,monospace;font-weight:700;text-rendering:optimizeLegibility;font-size:1.25rem;line-height:1.1}h5{font-size:1rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:Alegreya,monospace;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:hsla(var(--color-text-hsl),.04);border-radius:3px;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:hsla(var(--color-text-hsl),.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted hsla(var(--color-text-hsl),.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid hsla(var(--color-text-hsl),.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:hsla(var(--color-text-hsl),.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.4em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}:root,html[data-theme=light]{--color-background:#fff;--color-text:#212322;--color-text-hsl:0,0%,0%;--color-link-decoration:#e1e1e1;--color-main:#e1e1e1;--color-pre-background:#212322}html[data-theme=dark]{--color-background:#212322;--color-text:#fff;--color-text-hsl:0,100%,100%;--color-link-decoration:#a0a0a0;--color-main:#090915;--color-pre-background:#090915}body,html{margin:0;padding:0;font-family:Alegreya,monospace;font-weight:400;background-color:var(--color-background);color:var(--color-text);font-size:14px;line-height:1.555rem}@media (min-width:992px){body,html{font-size:18px}}.main-wrapper{min-height:100vh;display:flex;flex-direction:column}p{margin:0;text-align:left;line-height:1.5em}a,p{color:var(--color-text)}a{text-decoration:none}.link a{border-bottom:2px solid var(--color-link-decoration)}.link a:hover{background-color:var(--color-main)}.container{position:relative;margin:0 auto;display:flex;flex-wrap:wrap;justify-content:space-between;width:90%;max-width:1300px}@media (max-width:639px){.container{padding:0 20px}}@media (min-width:992px){.container--right{margin-right:5%;width:54%;max-width:779.9844px}}@media (min-width:992px) and (min-width:1300px){.container--right{margin-right:calc((100% - 1300px)/2)}}.hidden{display:none!important}.centered{text-align:center}@media (max-width:639px){.centered--mobile{justify-content:center;align-content:center;align-items:center}}.spacing{margin-top:2rem}@media (max-width:992px) and (min-width:640px){.spacing--tablet{margin-top:5rem!important}}@media (min-width:992px){.spacing{margin-top:5rem}}.spacing--small{margin-top:1rem}@media (min-width:992px){.spacing--small{margin-top:3.444rem}}.spacing--large{margin-top:4rem}@media (min-width:992px){.spacing--large{margin-top:10rem}}.spacing--extra-large{margin-top:4rem}@media (min-width:992px){.spacing--extra-large{margin-top:20rem}}.spacing--after{margin-bottom:2rem}@media (min-width:992px){.spacing--after{margin-bottom:5rem}}@media (max-width:639px){.spacing--after--mobile{margin-bottom:5rem}}@media (min-width:992px){.spacing--after-small{margin-bottom:2.5rem}}.spacing--after-large{margin-bottom:4rem}@media (min-width:992px){.spacing--after-large{margin-bottom:10rem}}@media (max-width:991px){.spacing--mobile{margin-top:2rem}}@media (max-width:1299px){.spacing--mobile--small{margin-top:1.5rem}}@media (max-width:1299px){.spacing--mobile--large{margin-top:3rem}}.col-1{width:100%}@media (min-width:992px){.col-1{width:10%}}.col-2{width:100%}@media (min-width:992px){.col-2{width:20%}}.col-3{width:100%}@media (min-width:992px){.col-3{width:30%}}.col-4{width:100%}@media (min-width:992px){.col-4{width:40%}}.col-5{width:100%}@media (min-width:992px){.col-5{width:50%}}.col-6{width:100%}@media (min-width:992px){.col-6{width:60%}}.col-7{width:100%}@media (min-width:992px){.col-7{width:70%}}.col-8{width:100%}@media (min-width:992px){.col-8{width:80%}}.col-9{width:100%}@media (min-width:992px){.col-9{width:90%}}.col-10{width:100%}@media (min-width:992px){.col-10{width:100%}}@media (min-width:992px){.push-right-1{margin-left:10%}.push-right-2{margin-left:20%}.push-right-3{margin-left:30%}.push-right-4{margin-left:40%}.push-right-5{margin-left:50%}.push-left-1{margin-right:10%}.push-left-2{margin-right:20%}.push-left-3{margin-right:30%}.push-left-4{margin-right:40%}.push-left-5{margin-right:50%}.push-left{margin-right:auto}.push-right{margin-left:auto}}@media (max-width:639px){.col-1--mobile{width:10%!important}.col-2--mobile{width:20%!important}.col-3--mobile{width:30%!important}.col-4--mobile{width:40%!important}.col-5--mobile{width:50%!important}.col-6--mobile{width:60%!important}.col-7--mobile{width:70%!important}.col-8--mobile{width:80%!important}.col-9--mobile{width:90%!important}.col-10--mobile{width:100%!important}.push-right-1--mobile{margin-left:10%!important}.push-right-2--mobile{margin-left:20%!important}.push-right-3--mobile{margin-left:30%!important}.push-right-4--mobile{margin-left:40%!important}.push-right-5--mobile{margin-left:50%!important}.push-left-1--mobile{margin-right:10%!important}.push-left-2--mobile{margin-right:20%!important}.push-left-3--mobile{margin-right:30%!important}.push-left-4--mobile{margin-right:40%!important}.push-left-5--mobile{margin-right:50%!important}.order-0--mobile{order:0}.order-1--mobile{order:1}.order-2--mobile{order:2}.order-3--mobile{order:3}.order-4--mobile{order:4}.order-5--mobile{order:5}.hidden--mobile{display:none}}@media (max-width:1299px){.col-1--tablet{width:10%}.col-2--tablet{width:20%}.col-3--tablet{width:30%}.col-4--tablet{width:40%}.col-5--tablet{width:50%}.col-6--tablet{width:60%}.col-7--tablet{width:70%}.col-8--tablet{width:80%}.col-9--tablet{width:90%}.col-10--tablet{width:100%}.order-0--tablet{order:0}.order-1--tablet{order:1}.order-2--tablet{order:2}.order-3--tablet{order:3}.order-4--tablet{order:4}.order-5--tablet{order:5}.order-0--mobile{order:0}.order-1--mobile{order:1}.order-2--mobile{order:2}.order-3--mobile{order:3}.order-4--mobile{order:4}.order-5--mobile{order:5}.hidden--mobile{display:none}}.centered-vertically{display:flex;flex-direction:column;justify-content:center}.nav-item-hover{text-decoration:none;color:var(--color-text);font-weight:500;padding:.2em}@media (min-width:640px){.nav-item-hover{font-weight:600}}.nav-item-hover:active,.nav-item-hover:focus,.nav-item-hover:hover{color:var(--color-background);background-color:var(--color-text)!important}.nav-item-hover:active,.nav-item-hover:focus{outline:2px solid #706be4}.nav-item-active{border-bottom:2px solid var(--color-text)}.flex-fix-aligning:after,.flex-fix-aligning:before{content:"";width:30%;order:2}.auto-bottom-margin{margin-bottom:auto}.frontpage-hero{flex-direction:column;flex-wrap:nowrap}@media (max-width:991px){.frontpage-hero__content{z-index:1;margin-bottom:3rem}}.frontpage-hero__heading{-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;font-size:2rem}@media (min-width:640px){.frontpage-hero__heading{font-size:2.5rem}}@media (min-width:1300px){.frontpage-hero__heading{font-size:3rem}}.frontpage-hero__cta{display:inline-block;margin-bottom:4rem}.frontpage-hero__description{max-width:626px}@media (max-width:991px){.frontpage-hero__image{position:absolute!important;right:-5%;top:-40px;opacity:.1}.frontpage-hero__image img{transform:translateX(33%)}}@media (max-width:639px){.frontpage-hero__image{right:-40px}}.heading-font{font-family:Noto Sans,monospace}.about__challenge-button{box-shadow:-3px 5px var(--color-text);padding:.6rem 1rem;border:3px solid var(--color-text);font-weight:600}.about__challenge-button:hover{background-color:var(--color-text);color:var(--color-background);cursor:pointer}.about__challenge-button--turquoise{background-color:#82f7eb}html[data-theme=dark] .about__challenge-button{color:var(--color-text);box-shadow:-3px 5px var(--color-text);border:3px solid var(--color-text)}html[data-theme=dark] .about__challenge-button:hover{background-color:var(--color-text);color:var(--color-background)}html[data-theme=dark] .about__challenge-button--turquoise{color:var(--color-main);box-shadow:-3px 5px var(--color-main);border:3px solid var(--color-main)}html[data-theme=dark] .about__challenge-button--turquoise:hover{background-color:var(--color-main);color:var(--color-text)}@media (max-width:1299px){.space-between--mobile{justify-content:space-between}}.challenge__banner{display:flex;justify-content:center;margin-bottom:-70px}@media (min-width:640px){.challenge__banner{transform:translateY(-10px)}}@media (min-width:1300px){.challenge__banner{margin-bottom:-370px}}.challenge__banner .image{margin:0;width:70%;transform:translateY(-25%)}@media (min-width:640px){.challenge__banner .image{transform:translateY(-10%)}}@media (min-width:1300px){.challenge__banner .image{transform:translateY(-30%)}}.header{position:-webkit-sticky;position:sticky;z-index:50;top:0;box-sizing:border-box;width:100%;padding-top:1.444rem;padding-bottom:1rem;transition:all .2s ease-in-out}.header--small{pointer-events:none}.header__logo{margin:0 10px;pointer-events:auto}.navigation{z-index:2;list-style:none;opacity:0;display:none;margin:0;padding:5%;flex-direction:column;justify-content:center;align-items:center;background:var(--color-main);position:fixed;top:8%;right:5%;transition:opacity .3s ease-in-out;font-weight:200}@media (min-width:1300px){.navigation{display:flex;opacity:1;padding:0;font-weight:400;position:static;background:none;overflow:hidden;flex-direction:row}}@media (max-width:1299px){.navigation__wrapper .language-switcher{margin:20px 0 0}}@media (min-width:1300px){.navigation__wrapper{flex-grow:100}}@media (max-width:1299px){.navigation__language-picker{margin-top:10px}}.navigation__icon-buttons{margin:30px 0 0}@media (min-width:1300px){.navigation__icon-buttons{width:100%;display:flex;justify-content:flex-end;margin:0 20px 0 0}}.navigation__toggle{z-index:3;position:absolute;top:0;right:0;width:50px;height:40px;cursor:pointer;border:none;background:none;outline:none;border-radius:4px}@media (min-width:1300px){.navigation__toggle{display:none}}.navigation__mobile-logo{display:none}.navigation__toggle-icon{top:8px;left:10px}.navigation__toggle-icon,.navigation__toggle-icon:after,.navigation__toggle-icon:before{position:absolute;width:30px;height:3px;transition:all .3s ease;border-radius:4px;background-color:var(--color-text)}.navigation__toggle-icon:after,.navigation__toggle-icon:before{content:"";display:block}.navigation__toggle-icon:before{top:10px}.navigation__toggle-icon:after{top:20px}@media (max-width:1299px){.is-open--navigation{overflow:hidden;height:100vh}.is-open--navigation .navigation{opacity:1;display:flex;align-items:flex-start}.is-open--navigation .navigation:before{content:"";background-color:var(--color-main);position:absolute;width:25px;height:25px;top:-3px;right:13px;transform:rotate(45deg)}.is-open--navigation .navigation__mobile-logo{display:block;width:30px;height:30px;position:absolute;top:47px;left:5%}}@media (max-width:1299px) and (min-width:1300px){.is-open--navigation .navigation__mobile-logo{display:none}}@media (max-width:1299px){.is-open--navigation .navigation__toggle-icon{transform:translate3d(0,10px,0) rotate(45deg)}.is-open--navigation .navigation__toggle-icon,.is-open--navigation .navigation__toggle-icon:after,.is-open--navigation .navigation__toggle-icon:before{background:var(--color-text)}.is-open--navigation .navigation__toggle-icon:before{transform:rotate(-45deg) translate3d(-5.71429px,-6px,0);opacity:0}.is-open--navigation .navigation__toggle-icon:after{transform:translate3d(0,-19px,0) rotate(-90deg)}}.navigation__item{margin:10px 0;white-space:nowrap}.navigation__item:first-of-type{margin:0 0 10px}.navigation__item:last-of-type{margin:10px 0 0}@media (min-width:1300px){.navigation__item{margin:0 15px;padding:0!important}.navigation__item:first-of-type{margin:0 15px 0 2rem}.navigation__item:last-of-type{margin:0 0 0 15px}}.element--flex{display:flex;flex-wrap:wrap}.element--space-around{justify-content:space-around}.element--space-between{justify-content:space-between}.element--column{flex-direction:column}.element--centered{align-items:center;justify-content:center!important}@media (min-width:992px){.element--centered-in-desktop{align-items:center;justify-content:center!important}}@media (min-width:992px){.element--horizontal-half{width:45%}}.element--auto-margin{margin:auto}.element--auto-bottom-margin{margin-bottom:auto}.element--flex-start{align-content:flex-start}.element--no-wrap{flex-wrap:nowrap}.element--relative{position:relative!important}.SvgIcon-module--svgIcon--1nGJ6{-webkit-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;flex-shrink:0;font-size:1.5rem}.SrOnly-module--srOnly--2Hn2L{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.SearchLink-module--searchLink--2IShR{margin-right:20px;border-radius:4px;padding:4px;display:inline-flex}.SearchLink-module--searchLink--2IShR:focus,.SearchLink-module--searchLink--2IShR:hover{background-color:var(--color-text);color:var(--color-background)}.ThemeSwitcher-module--themeSwitcher--1gbnJ{border-radius:4px;padding:4px;display:inline-flex;background:none;border:none;color:var(--color-text)}.ThemeSwitcher-module--themeSwitcher--1gbnJ:hover{background-color:var(--color-text)!important;color:var(--color-background)!important;cursor:pointer}.ThemeSwitcher-module--themeSwitcher--1gbnJ:focus{background-color:var(--color-text);color:var(--color-background)}.ThemeSwitcher-module--themeSwitcher--1gbnJ:focus:not(:focus-visible){color:var(--color-text);background:none}.banner{display:flex;width:100%;align-items:center;position:relative;padding:2rem 0;background-color:var(--color-main)}@media (min-width:992px){.banner{padding:3.444rem 3.444rem 4.444rem}}.edit-link>span{border-bottom-width:3px;border-bottom-style:solid;border-bottom-color:inherit}.edit-link:hover{color:#212322}.prev-next__container a:hover{color:#212322;background-color:#fff}.prev-next__container a:hover b,.prev-next__container a:hover p{color:#212322}.prev-next__container .separator{display:none}@media (max-width:639px){.prev-next__container .separator{display:block;background-color:var(--color-text);width:2px!important}}.prev-next__container .prev b,.prev-next__container .prev p{text-align:right}@media (max-width:639px){.prev-next__container .prev p:before{content:"<";margin-right:1rem}}@media (max-width:639px){.prev-next__container .next p:after{content:">";margin-left:1rem}}.scroll-navigation-container{display:none}@media (min-width:992px){.scroll-navigation-container{pointer-events:none;display:block;font-size:16px;position:-webkit-sticky;position:sticky;width:100%;margin-right:-100%;left:0;top:-100px;padding-top:200px}}.scroll-navigation-container-inner{width:90%;margin:0 auto;max-width:1200px}.scroll-navigation{pointer-events:auto;display:flex;width:30%;max-width:30%/.9;height:100%;overflow-y:auto;max-height:calc(100vh - 100px);padding-right:1rem;z-index:30}.scroll-navigation li{list-style-type:none;font-family:Noto Sans,monospace}html[data-theme=light] .scroll-navigation li{font-family:Gelasio,monospace}.scroll-navigation li.selected a,.scroll-navigation li:hover a{background-color:var(--color-text);color:var(--color-background)!important}.scroll-navigation li:before{content:"-"}.left-navigation-link{padding-left:1.2rem;text-indent:-1.2rem;display:block}.left-navigation-link:hover{background-color:var(--color-text)!important;color:var(--color-background)!important}.level-h1{font-weight:700;padding-left:2.8rem;text-indent:-2.8rem}.level-h2{padding-left:1.6rem;text-indent:-1.6rem}.triple-border{position:relative;padding:2px;border-radius:5px 0;transition:color .1s ease-in-out,background-color .1s ease-in-out}.triple-border:after,.triple-border:before{z-index:2;content:"";border:2px solid var(--color-text);border-radius:5px;position:absolute;width:calc(100% + 5px);height:calc(100% + 5px)}.triple-border:before{left:0;top:0}.triple-border:after{bottom:0;right:0}.triple-border__container{position:relative;overflow:hidden;border-radius:3px 0}.triple-border--large-margin{margin:13px;padding:3px}.triple-border--large-margin:after,.triple-border--large-margin:before{content:"";border-width:3px;border-radius:13px;width:calc(100% + 13px);height:calc(100% + 13px)}.triple-border--large-margin .triple-border__container{border-radius:10px 0}.triple-border__logo{padding:.2rem;font-size:1.111rem;font-weight:600}html[data-theme=dark] .triple-border:hover .triple-border__logo--small{color:#212322!important}.triple-border__return-tasks{font-size:.9rem;padding:1rem .2rem}#footer{margin-top:auto}@media (min-width:992px){#footer{align-items:center}}#footer a:hover{background-color:transparent!important}#footer .footer__navigation{display:none}@media (max-width:1299px){#footer .footer__navigation{width:100%;display:block}#footer .footer__navigation-link-container{display:flex;flex-direction:column}}#footer .footer__navigation-link{font-size:1rem;line-height:18px;white-space:nowrap;font-family:Noto Sans,monospace;margin-left:0!important;margin-right:auto}@media (max-width:639px){#footer .footer__navigation-link{line-height:8px}}#footer .footer__navigation-link:hover{color:var(--color-background)!important;background-color:var(--color-text)!important}#footer .footer__navigation-link:nth-of-type(n+2){margin-top:2.142rem}@media (min-width:1300px){#footer .footer__navigation{flex-direction:row;flex-wrap:nowrap;justify-content:flex-end}#footer .footer__navigation-link{margin-top:0!important;margin-bottom:auto}#footer .footer__navigation-link:nth-of-type(n+1){margin-right:2.877rem}#footer .footer__navigation-link:last-of-type{margin-right:0!important}}.image__content{position:absolute;top:0;left:0;height:100%;width:100%;-o-object-fit:cover;object-fit:cover}.image--contain .image__content{-o-object-fit:contain;object-fit:contain}.image{overflow:hidden;width:100%;position:relative}@media (min-width:992px){.image{width:40%}}.image .image__container{height:0;position:relative;width:100%;padding-bottom:89.0625%}.image--circle{border-radius:50%}.image--circle .image__content{background-color:var(--color-main)}.image--square-big{width:100%}.image--square-big .image__container{width:100%;padding-bottom:100%}.image--extra-small{width:8%}.image--extra-small .image__container{width:100%;padding-bottom:100%}@media (max-width:639px){.image--extra-small{width:calc(33.33333% - 1rem)}}.image--small{width:15%}.image--small .image__container{width:100%;padding-bottom:100%}@media (max-width:639px){.image--small{width:calc(33.33333% - 1rem)}}.image--medium{width:50%}.image--medium .image__container{width:100%;padding-bottom:71.25%}.image--large{width:100%}@media (min-width:992px){.image--large{width:60%}}.image--large .image__container{padding-bottom:59.37%;width:100%}.image--full-width{width:100%}.image--full-width .image__container{padding-bottom:59.37%;width:100%}.image--actual-size{width:100%}.image--actual-size .image__container{height:0;position:relative;width:100%;padding-bottom:60%}html[data-theme=dark] .image--backdrop .image__container{background:#fff;border-radius:10px}html[data-theme=dark] .image--invert img{-webkit-filter:invert(1);filter:invert(1)}.body-text:not(:last-of-type){margin-bottom:2.5rem}.body-text__title{color:var(--color-text);font-size:1.44rem;line-height:1.25em;font-weight:700;margin:0;position:relative;top:50%;transform:translateY(-50%)}.body-text__content:not(:last-of-type){padding-bottom:2em}.bold{font-weight:700}.body-text--no-padding{padding:0!important}@media (min-width:640px){.companies__main-title .body-text__title{font-size:3rem}}.challenge-title{font-size:1.44rem}.skip-to-content{position:absolute;top:-50px;left:50%;height:50px;padding:0 30px;transform:translateX(-50%);background-color:var(--color-text);color:var(--color-background);border-radius:0 0 3px 3px;transition:top .3s;display:inline-flex;justify-content:center;align-items:center;z-index:100}.skip-to-content:focus{top:0;transition:top .25s}.company__logo{padding:10px}@media (min-width:992px){.company__logo{width:15%!important}}.content-liftup{position:relative;text-decoration:none}.content-liftup--small{box-sizing:border-box}.content-liftup--small>:last-child{margin-bottom:0}.content-liftup--padding{padding:10px}.content-liftup__name{margin-top:1.5rem;color:var(--color-text);font-weight:700}@media (min-width:992px){.content-liftup__name{margin-top:2rem}}.content-liftup__summary{margin-top:1rem;margin-bottom:3rem;color:var(--color-text);line-height:28px}.content-liftup__link:focus .image{opacity:.6}.content-liftup__link:focus:not(:focus-visible) .image{opacity:1}.content-liftup .content-liftup__image:after{content:"";position:absolute;top:0;left:0;height:100%;width:100%;opacity:.5;z-index:2}.some-logo__link{margin:1rem 1rem 0 0;display:inline-block}.some-logo__image{width:1.5rem;height:1.5rem;margin:0}html[data-theme=dark] .some-logo__image{-webkit-filter:invert(1);filter:invert(1)}.sub-header{color:var(--color-text);font-family:Alegreya,monospace;padding-bottom:1.357rem}@media (min-width:992px){.sub-header{padding-bottom:2.333rem}}.copy-code-button,.copy-code-button:host{display:inline-flex}.copy-code-button{align-items:center;justify-content:center;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin:0;padding:.5rem;background:var(--color-pre-background);border:none;border-radius:.25rem;box-shadow:0 .25rem .5rem rgba(0,0,0,.25);color:#fff;cursor:pointer;font-weight:600;opacity:.2;transition:.2s ease-in-out}.copy-code-button:hover{opacity:1}.copy-code-button:active{opacity:0;color:red}pre{overflow:auto;padding:1rem;border-radius:.5rem;position:relative}pre .copy-code-button{position:absolute;top:.5rem;right:.5rem}code{white-space:pre-wrap!important}.InputField-module--inputField--3oXh5{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:100%;border:0;font-family:inherit;padding:16px 12px;box-shadow:inset 0 -1px 0 var(--color-text);color:var(--color-text);background-color:var(--color-background);transition:all .15s ease}.InputField-module--inputField--3oXh5:hover{box-shadow:inset 0 -2px 0 var(--color-text)}.InputField-module--inputField--3oXh5:focus{outline:none;box-shadow:inset 0 -2px 0 var(--color-text)}.developer-story__image{margin-bottom:auto}html[data-theme=dark] .developer-story__company-logo-wrapper{margin-bottom:20px;display:inline-flex;justify-content:center;align-items:center;background:#fff;border-radius:10px;padding:15px}html[data-theme=dark] .developer-story__company-logo-wrapper img{margin:0 auto}.developer-story__name{margin-top:4rem;font-size:1.2rem}.developer-story__title{font-size:.9rem}.developer-story__read-more{margin-top:2rem;line-height:1.1rem;width:auto;background:none;color:inherit;border:none;padding:0!important;border-bottom:2px solid var(--color-link-decoration);cursor:pointer}.developer-story__read-more:hover{background-color:var(--color-main)}</style><meta name="generator" content="Gatsby 2.23.22"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><title data-react-helmet="true">COMP227 part4 | </title><meta data-react-helmet="true" name="description" content="Online instructional materials for COMP 227 from the University of the Pacific"/><meta data-react-helmet="true" property="og:title" content="COMP227 part4 | "/><meta data-react-helmet="true" property="og:description" content="Online instructional materials for COMP 227 from the University of the Pacific"/><meta data-react-helmet="true" name="og:image" content="/static/EYE_green_wide-0a72f74a959f54d0f3e4bb8c67f6f158.jpg"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Courtesy of Houston Inc. Consulting oy"/><meta data-react-helmet="true" name="twitter:title" content="COMP227 part4 | "/><meta data-react-helmet="true" name="twitter:description" content="Online instructional materials for COMP 227 from the University of the Pacific"/><meta data-react-helmet="true" name="twitter:image" content="/static/EYE_green_wide-0a72f74a959f54d0f3e4bb8c67f6f158.jpg"/><meta data-react-helmet="true" name="google-site-verification" content="ds9pQKiK3kjhRSHHbf5ccoG-oJggn7Lq4A8uHxM3Mkw"/><meta data-react-helmet="true" name="keywords" content="course, comp227, web, React, Redux, Node.js, Node, MongoDB, REST, REST api, web development, software development, web, web application, single page app, programming, "/><link rel="icon" href="/favicon-32x32.png?v=4f8f16056b4105571e7bfe7c33fe98f3"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#e1e1e1"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4f8f16056b4105571e7bfe7c33fe98f3"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4f8f16056b4105571e7bfe7c33fe98f3"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4f8f16056b4105571e7bfe7c33fe98f3"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4f8f16056b4105571e7bfe7c33fe98f3"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4f8f16056b4105571e7bfe7c33fe98f3"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4f8f16056b4105571e7bfe7c33fe98f3"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4f8f16056b4105571e7bfe7c33fe98f3"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4f8f16056b4105571e7bfe7c33fe98f3"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-47G19EZV14"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-47G19EZV14', {"send_page_view":false});
      }
      </script><link rel="canonical" href="https://comp227.djosv.com/part4/testing_the_backend" data-baseprotocol="https:" data-basehost="comp227.djosv.com"/><script>
  (function() {
    try {
      const savedTheme = localStorage.getItem('selected_theme');

      if (savedTheme) {
        document.documentElement.dataset.theme = savedTheme;
      } else if (
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      ) {
        document.documentElement.dataset.theme = 'dark';
      }
    } catch (e) {}
  })();
  </script><link as="script" rel="preload" href="/7dd12e78b77ad11302d3983d1a97a16cf64ad671-91cf5431cb3e1fc76518.js"/><link as="script" rel="preload" href="/app-dd357ea592e758b99643.js"/><link as="script" rel="preload" href="/component---src-templates-content-template-js-d6ac83f8ee71944e42d9.js"/><link as="script" rel="preload" href="/e4354a253f92224f15d9052b835f37a9cce77cf7-4624078180071cfa198f.js"/><link as="script" rel="preload" href="/styles-89fd2ae28bdf06750a71.js"/><link as="script" rel="preload" href="/aa63343c7cf9d92e00ea1a246d5d0f4f54465620-7e7bd772c5bbcf0f4851.js"/><link as="script" rel="preload" href="/bd3b11e4ab29109ed2b86501ebb9c0833718e029-306c9da09477fa9d50eb.js"/><link as="script" rel="preload" href="/commons-04451b38a7b232ddc46f.js"/><link as="script" rel="preload" href="/framework-8cb3270495e919798e3b.js"/><link as="script" rel="preload" href="/webpack-runtime-8e24bcdbf9da631062c7.js"/><link as="fetch" rel="preload" href="/page-data/part4/testing_the_backend/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="main-wrapper"><a href="#course-main-content" class="skip-to-content">Skip to content</a><header class="header " style="background-color:var(--color-background)"><div class="container" style="align-items:center;justify-content:flex-start"><a class="header__logo" href="/"><div class="triple-border nav-item-hover " style="padding:0.2em"><div class="triple-border__container triple-border__logo" style="background-color:transparent;z-index:10">{() =&gt; comp227}</div></div></a><div class="navigation__wrapper "><button aria-label="Navigation menu" aria-expanded="false" class="navigation__toggle"><div class="navigation__toggle-icon"></div></button><nav><ul class="navigation"><li class="navigation__item "><a class="nav-item-hover" href="/about">About course</a></li><li class="navigation__item "><a class="nav-item-hover" href="/#course-contents">Course contents</a></li><li class="navigation__item "><a class="nav-item-hover" href="/part0/syllabus">Syllabus</a></li><li class="navigation__item "><a class="nav-item-hover" href="/faq">FAQ</a></li><li class="navigation__item "><a class="nav-item-hover" href="/thanks">Acknowledgements</a></li><div class="navigation__icon-buttons"><a class="SearchLink-module--searchLink--2IShR" href="/search"><span class="SrOnly-module--srOnly--2Hn2L">Search from the material</span><svg role="img" viewBox="0 0 24 24" class="SvgIcon-module--svgIcon--1nGJ6"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></a><button class="ThemeSwitcher-module--themeSwitcher--1gbnJ" aria-pressed="false"><span class="SrOnly-module--srOnly--2Hn2L">Toggle dark theme</span><svg role="img" viewBox="0 0 384 512" class="SvgIcon-module--svgIcon--1nGJ6"><path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path></svg></button></div></ul></nav></div></div></header><main id="main-content"><div class="course-container spacing--after"><div class="banner part-main__banner spacing--mobile--small" style="background-image:url(/static/f800638504cdf371a12947fc31d52030/part-4.svg);background-color:#F7F382"><div class="container spacing--after"><div class="col-10 spacing--after"><div class="arrow__container arrows--horizontal breadcrumb"><div class="arrow__wrapper"><div class="arrow__rectangle  " style="background-color:#F7F382;color:#33332d"><a href="/#course-contents">COMP227</a></div><div class="arrow__point " style="background-color:#F7F382;color:#33332d"></div></div><div class="arrow__wrapper"><div class="arrow__rectangle  " style="background-color:#F7F382;color:#33332d"><a href="/part4">Part 4</a></div><div class="arrow__point " style="background-color:#F7F382;color:#33332d"></div></div><div class="arrow__wrapper"><div class="arrow__rectangle  " style="background-color:#33332d;color:white">Testing the backend</div><div class="arrow__point " style="background-color:#33332d;color:white"></div></div></div></div></div></div><div class="course " id="course-main-content"><div class="scroll-navigation-container "><div class="scroll-navigation-container-inner "><div class="scroll-navigation  element--column" tag="ul"><a class="left-navigation-link" style="border-color:#F7F382" href="/part4/structure_of_backend_application_introduction_to_testing">a Structure of backend application, introduction to testing</a><div class="accordion__container col-8 push-right-1 accordion--side-navigation"><button class="accordion accordion__title  " style="background-color:#F7F382;border-color:#F7F382" aria-controls="b_testing_the_backend" aria-expanded="false">b Testing the backend</button></div><a class="left-navigation-link" style="border-color:#F7F382" href="/part4/user_administration">c User administration</a><a class="left-navigation-link" style="border-color:#F7F382" href="/part4/token_authentication">d Token authentication</a></div></div></div><div class="course-content-container "><div class="course-content element--auto-bottom-margin"><div class="course-content-inner "><p class="col-1 letter" style="border-color:#F7F382">b</p><h1 class="sub-header ">Testing the backend</h1></div></div><div class="course-content "><div class="course-content-inner ">
<p>We will now start writing tests for the backend.
Since the backend does not contain any complicated logic, it doesn&#x27;t make sense to write <a href="https://en.wikipedia.org/wiki/Unit_testing">unit tests</a> for it.
The only potential thing we could unit test is the <code class="language-text">toJSON</code> method that is used for formatting tasks.</p>
<p>In some situations, it can be beneficial to implement some of the backend tests by mocking the database instead of using a real database.
One library that could be used for this is <a href="https://github.com/nodkz/mongodb-memory-server">mongodb-memory-server</a>.</p>
<p>Since our application&#x27;s backend is still relatively simple,
we will decide to test the entire application through its REST API, so that it also tests the database at the same time.
This kind of testing where multiple components are combined and tested as a unit is called <a href="https://en.wikipedia.org/wiki/Integration_testing"><strong style="color:#6D5005">integration testing</strong></a>.</p>
<h3>Specifying Application modes</h3>
<p>Your backend can have a variety of modes that it can be in.
For example, we mentioned that when your backend server is running in Render, it is in <strong style="color:#6D5005">production</strong> mode.</p>
<p>The convention in Node is to define the execution mode of the application with the <code class="language-text">NODE_ENV</code> environment variable.
In using Render, we were lucky enough that we were able to use the same <em>.env</em> file that we had in our development environment.
Other services only allow you to set variables manually through their site,
which means that the environment variables defined in the <em>.env</em> file would *only be loaded if the application is in <strong style="color:#6D5005">production mode*</strong>.</p>
<p>Because of tiny nuances like this, it is common practice to define separate modes for development and testing.</p>
<p>To do that, let&#x27;s change the scripts in our <em>package.json</em> to include which mode we are in. For example when tests are run, <code class="language-text">NODE_ENV</code> gets the value <code class="language-text">test</code>:</p>
<div class="gatsby-highlight" data-language="json"><pre><code class="language-json"><span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NODE_ENV=production node index.js&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NODE_ENV=development nodemon index.js&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NODE_ENV=test jest --verbose --runInBand&quot;</span><span class="token punctuation">,</span></span>    <span class="token property">&quot;build:ui&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rm -rf dist &amp;&amp; cd ../reading/ &amp;&amp; npm run build &amp;&amp; cp -r dist ../backend-reading&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;deploy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:ui &amp;&amp; git add . &amp;&amp; git commit -m npm_generated_rebuild_of_the_UI &amp;&amp; git push&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint .&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:fix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run lint -- --fix&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We also added the <a href="https://jestjs.io/docs/cli#--runinband"><code class="language-text">runInBand</code> option</a> to the npm script that executes the tests.
This option will prevent Jest from running tests in parallel; we will discuss its significance once our tests start using the database.</p>
<p>We also specified the application mode (<code class="language-text">NODE_ENV</code>) as:</p>
<ul>
<li><strong style="color:#6D5005"><em>development</em></strong> in the <code class="language-text">npm run dev</code> script that uses nodemon.</li>
<li><strong style="color:#6D5005"><em>production</em></strong> in the default <code class="language-text">npm start</code> command.</li>
</ul>
<blockquote>
<p><strong style="color:#6D5005">Windows Users:</strong> There is a slight issue in how we have set up the application mode in our scripts: it will not work on Windows 😔.
We can correct this by installing the <a href="https://www.npmjs.com/package/cross-env">cross-env</a> package:</p>
<div class="gatsby-highlight" data-language="bash"><pre><code class="language-bash"><span class="token function">npm</span> i -D cross-env</code></pre></div>
<p>We can then achieve cross-platform compatibility by using the cross-env library in our npm scripts defined in <em>package.json</em>:</p>
<div class="gatsby-highlight" data-language="json"><pre><code class="language-json"><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=production node index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=development nodemon index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=test jest --verbose --runInBand&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<blockquote>
<p><strong style="color:#6D5005">Remember:</strong>: If you are deploying this application to a cloud service,
keep in mind that if cross-env is saved as a development dependency, it may cause an application error on your web server.
To fix this, <strong style="color:#6D5005"><em>change cross-env to a production dependency</em></strong> by running this in the command line:</p>
<div class="gatsby-highlight" data-language="bash"><pre><code class="language-bash"><span class="token function">npm</span> i -P cross-env</code></pre></div>
</blockquote>
</blockquote>
<h4>Leveraging Application Modes in Code</h4>
<p>Now we can modify the way that our application runs in different modes.
As an example of this, we could define the application to use a separate test database when it is running tests.</p>
<p>We can create our separate test database in MongoDB Atlas.
This is not an optimal solution in situations where many people are developing the same application.
Test execution in particular typically requires a single database instance that is not used by tests that are running concurrently.</p>
<p>It would be better to run our tests using a database that is installed and running on the developer&#x27;s local machine.
The optimal solution would be to have every test execution use a separate database.
This is &quot;relatively simple&quot; to achieve by <a href="https://docs.mongodb.com/manual/core/inmemory/">running Mongo in-memory</a> or by using <a href="https://www.docker.com">Docker</a> containers.
Nonetheless, to reduce complexity at this point we will instead continue to use the MongoDB Atlas database.</p>
<p>Let&#x27;s make some changes to the module that defines the application&#x27;s configuration, <em>utils/config.js</em>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;dotenv&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> <span class="token constant">MONGODB_URI</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;test&quot;</span></span><span class="gatsby-highlight-code-line">  <span class="token operator">?</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">TEST_MONGODB_URI</span></span><span class="gatsby-highlight-code-line">  <span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">MONGODB_URI</span><span class="token punctuation">;</span></span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">MONGODB_URI</span><span class="token punctuation">,</span>
  <span class="token constant">PORT</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>The <em>.env</em> file has <strong style="color:#6D5005"><em>separate variables</em></strong> for the database addresses of the development and test databases:</p>
<div class="gatsby-highlight" data-language="bash"><pre><code class="language-bash"><span class="token assign-left variable">MONGODB_URI</span><span class="token operator">=</span>mongodb+srv://comp227:<span class="token operator">&lt;</span>password<span class="token operator">&gt;</span>@cluster0.gb6u3el.mongodb.net/taskApp?retryWrites<span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">w</span><span class="token operator">=</span>majority
<span class="token assign-left variable">PORT</span><span class="token operator">=</span><span class="token number">3001</span>

<span class="gatsby-highlight-code-line"><span class="token assign-left variable">TEST_MONGODB_URI</span><span class="token operator">=</span>mongodb+srv://comp227:<span class="token operator">&lt;</span>password<span class="token operator">&gt;</span>@cluster0.gb6u3el.mongodb.net/testTaskApp?retryWrites<span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">w</span><span class="token operator">=</span>majority</span></code></pre></div>
<p>The <em>config</em> module that we have implemented slightly resembles the <a href="https://github.com/lorenwest/node-config"><em>node-config</em> package</a>.
Writing our implementation is justified since our application is simple, and also because it teaches us valuable lessons.</p>
<p>These are the only changes we need to make to our application&#x27;s code.</p>
<p>You can find the code for our current application in its entirety in the <em>part4-2</em> branch of
<a href="https://github.com/comp227/part3-tasks-backend/tree/part4-2">this GitHub repository</a>.</p>
<h3>supertest</h3>
<p>Let&#x27;s use the <a href="https://github.com/visionmedia/supertest"><em>supertest</em> package</a> to help us write our tests for testing the API.</p>
<p>We will install the package as a development dependency:</p>
<div class="gatsby-highlight" data-language="bash"><pre><code class="language-bash"><span class="token function">npm</span> i -D supertest</code></pre></div>
<p>Let&#x27;s write our first test in the <em>tests/task_api.test.js</em> file:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> supertest <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;supertest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token function">supertest</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;tasks are returned as json&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> api
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The test imports the Express application from the <em>app.js</em> module and wraps it with the <code class="language-text">supertest</code> function
into a so-called <a href="https://github.com/visionmedia/superagent"><em>superagent</em> object</a>.
This object is assigned to the <code class="language-text">api</code> variable and tests can use it for making HTTP requests to the backend.</p>
<p>Our test makes an HTTP GET request to the <strong style="color:#6D5005"><em>api/tasks</em></strong> URL and verifies that the request is responded to with the status code 200.
The test also verifies that the <code class="language-text">Content-Type</code> header is set to <em><code class="language-text">application/json</code></em>, indicating that the data is in the desired format.</p>
<p>Checking the value of the header uses a bit strange looking syntax:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The desired value is now defined as a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions">regular expression</a> or in short <strong style="color:#6D5005">regex</strong>.
The regex starts and ends with a slash <code class="language-text">/</code>, because the desired string <em><code class="language-text">application/json</code></em> also contains the same slash,
it is preceded by a <em><code class="language-text">\</code></em> so that it is not interpreted as a regex termination character.</p>
<p>In principle, the test could also have been defined as a string</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The problem here, however, is that when using a string, the value of the header <em>must be exactly the same</em>.
For the regex we defined, it is acceptable that the header <em>contains</em> the string in question.
The actual value of the header is <em><code class="language-text">application/json; charset=utf-8</code></em>, i.e. it also contains information about character encoding.
However, our test is not interested in this and therefore it is <strong style="color:#6D5005"><em>better to define the test as a regex instead of an exact string</em></strong>.</p>
<p>The test contains some details that we will explore <a href="/part4/testing_the_backend#async-await">a bit later on</a>.
The arrow function that defines the test is preceded by the <strong style="color:#6D5005"><code class="language-text">async</code></strong> keyword and the method call for the <em>api</em> object is preceded by the <strong style="color:#6D5005"><code class="language-text">await</code></strong> keyword.
We will write a few tests and then take a closer look at this <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> magic.
Do not concern yourself with them for now, just be assured that the example tests work correctly.
The <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> syntax is related to the fact that making a request to the API is an <em>asynchronous</em> operation.
The <a href="https://jestjs.io/docs/asynchronous"><em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> syntax</a> can be used for writing asynchronous code with the appearance of synchronous code.</p>
<blockquote>
<p><strong style="color:#6D5005">FYI:</strong> If you&#x27;re not familiar with the RegEx syntax of <code class="language-text">/application\/json/</code>,
you can learn more <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions">via Mozilla&#x27;s documentation</a>.
I would strongly encourage you all to practice working more with regular expressions!
If you&#x27;re just plain rusty with regex and need practice, then there many sites that can help you test your regex as well, like <a href="https://regex101.com/">regex101</a>.</p>
</blockquote>
<p>The test contains some details that we will explore <a href="/part4/testing_the_backend#async-await">a bit later on</a>.
The arrow function that defines the test is preceded by the <code class="language-text">async</code> keyword
and the method call for the <code class="language-text">api</code> object is preceded by the <code class="language-text">await</code> keyword.
We will write a few tests and then take a closer look at <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em>.
Do not concern yourself with them for now, just be assured that the example tests work correctly.
The async/await syntax is related to the fact that making a request to the API is an <strong style="color:#6D5005">asynchronous</strong> operation.
The <a href="https://jestjs.io/docs/asynchronous">Async/await syntax</a> can be used for writing asynchronous code with the appearance of synchronous code.</p>
<p>Once all the tests (<em>there is currently only one</em>) have finished running, we have to close the database connection used by Mongoose.
This can be achieved with the <a href="https://jestjs.io/docs/api#afterallfn-timeout"><code class="language-text">afterAll</code> method</a>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h4>Dealing with some supertest and jest warnings</h4>
<p>At this point, you may end up noticing that WebStorm will flag some false positive warnings in your code.
Particularly you may see an error like this:</p>
<picture><img style="border-color:#F7F382" alt="jest supertest is having issues" src="/static/2d03cfe464c6bf4ae9f5353082733f42/5a190/supertest_get_call.png"/></picture>
<p>Your code still runs, but we want to prevent as many of these false positives from causing us to lose confidence in WebStorm&#x27;s excellent warning system.
So to remove this, we can do something similar to what we did <a href="/part4/#handling-complaints-about-jest">for removing jest errors</a> and issuing an npm command.</p>
<p>This time, I&#x27;ll show you how to do this from WebStorm.
Open <em>package.json</em> and locate the <code class="language-text">supertest</code> dependency.
Then either right-click (or use your keyboard shortcut) to open up the context actions and select <strong style="color:#6D5005"><em>install @types/supertest</em></strong> option and you should be set.</p>
<picture><img style="border-color:#F7F382" alt="install supertest option from package.json" src="/static/abb1c07dcb0812c4c7f424d235661bca/5a190/install_types_supertest.png"/></picture>
<p>For many of the libraries, we&#x27;ll be able to download those types to have more information that WebStorm can provide us,
and I think it&#x27;s prudent to install as many as they allow as <em><code class="language-text">devDependencies</code></em>.</p>
<h4>Mongoose related warnings</h4>
<p>While <em>mongoose</em> is a very popular library, there are some intricacies that we may end up having to deal with.</p>
<p>For example, when running your tests you may run across the following console warning:</p>
<picture><img style="border-color:#F7F382" alt="jest console warning about not exiting" src="/static/60b57f9cbebe7d870f0b9b09f392abff/5a190/8.png"/></picture>
<p>The problem is quite likely caused by the Mongoose version 6.x, the problem does not appear when versions 5.x or 7.x are used.
<a href="https://mongoosejs.com/docs/jest.html">Mongoose documentation</a> does not recommend testing Mongoose applications with Jest.</p>
<p><a href="https://stackoverflow.com/questions/50687592/jest-and-mongoose-jest-has-detected-opened-handles">One way</a>
to get rid of this is to add the file <em>tests/teardown.js</em> with the following content:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>and by extending the Jest definitions in the <em>package.json</em> like this:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token punctuation">{</span>
 <span class="token comment">//...</span>
 <span class="token string">&quot;jest&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token string">&quot;testEnvironment&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">   <span class="token string">&quot;globalTeardown&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./tests/teardown.js&quot;</span></span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h4>Tests taking a long time</h4>
<p>Another error you may come across is your test takes longer than the default Jest test timeout of 5000 ms.
This can be solved by adding a third parameter to our <em>task_api.test.js</em> function:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;tasks are returned as json&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> api
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre></div>
<p>This third parameter sets the timeout to <em><code class="language-text">100000</code></em> ms.
A long timeout ensures that our test won&#x27;t fail due to the time it takes to run.
(A long timeout may not be what you want for tests based on performance or speed, but this is fine for our example tests).</p>
<p>If you still encounter issues with <em>mongoose</em> timeouts, set <code class="language-text">bufferTimeoutMS</code> variable to a value significantly higher than 10000 (10 seconds).
You could set it like this at the top, right after the <code class="language-text">require</code> statements: <code class="language-text">mongoose.set(&quot;bufferTimeoutMS&quot;, 30000)</code></p>
<blockquote>
<p><strong style="color:#6D5005">Pertinent</strong>: at the <a href="/part4/structure_of_backend_application_introduction_to_testing#project-structure">beginning</a>
of this part we extracted the Express application into the <em>app.js</em> file,
and the role of the <em>index.js</em> file was changed to launch the application at the specified port via <code class="language-text">app.listen</code>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// the actual Express app</span>
<span class="token comment">// ...</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Server running on port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The tests only use the express application defined in the <em>app.js</em> file, which doesn&#x27;t listen to any ports.</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> supertest <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;supertest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token function">supertest</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token comment">// ...</span></code></pre></div>
<p>The documentation for supertest says the following:</p>
<blockquote>
<p><em>if the server is not already listening for connections then it is bound to an ephemeral port for you so there is no need to keep track of ports.</em></p>
</blockquote>
<p>In other words, <strong style="color:#6D5005"><em>supertest makes sure that the application being tested is started at the port that it uses internally</em></strong>.</p>
</blockquote>
<p>Let&#x27;s write a few more tests:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;there are two tasks&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;the first task is about HTTP methods&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;Wash the dishes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Both tests store the response of the request to the <code class="language-text">response</code> variable,
and unlike the previous test that used the methods provided by <em>supertest</em> for verifying the status code and headers,
this time <strong style="color:#6D5005"><em>we are inspecting the response data stored in <code class="language-text">response.body</code> property</em></strong>.
Our tests verify the format and content of the response data with the <a href="https://jestjs.io/docs/expect#expectvalue"><code class="language-text">expect</code> method</a> of Jest.</p>
<p>The benefit of using the <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> syntax is starting to become evident.
Normally we would have to use callback functions to access the data returned by promises, but with the new syntax things are a lot more comfortable:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// execution gets here only after the HTTP request is complete</span>
<span class="token comment">// the result of HTTP request is saved in variable response</span>
<span class="token function">expect</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The middleware that outputs information about the HTTP requests is obstructing the test execution output.
Let us modify <em>utils/logger.js</em> so that it does not print to the console in test mode:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">info</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> </span><span class="gatsby-highlight-code-line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">...</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">error</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> </span><span class="gatsby-highlight-code-line">    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token operator">...</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  info<span class="token punctuation">,</span> error
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h3>Initializing the database before tests</h3>
<p>Testing appears to be easy and our tests are currently passing.
However, our tests are problematic because they are dependent on the state of the database (which happens to be correct in my test database).
To make our tests more robust, we have to <strong style="color:#6D5005"><em>reset the database and generate the needed test data in a controlled manner before we run the tests</em></strong>.</p>
<p>Our tests are already using <a href="https://jestjs.io/docs/api#afterallfn-timeout">Jest&#x27;s <code class="language-text">afterAll</code> function</a>
to close the connection to the database after the tests are finished executing.
Jest offers many other <a href="https://jestjs.io/docs/setup-teardown">functions</a>
that can be used for executing operations once before any test is run or every time before a test is run.</p>
<p>In <em>task_api.test.js</em>, let&#x27;s initialize the database <strong style="color:#6D5005"><em>before every test</em></strong> with the <a href="https://jestjs.io/docs/en/api.html#beforeeachfn-timeout"><code class="language-text">beforeEach</code> function</a>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> supertest <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;supertest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token function">supertest</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> Task <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../models/task&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> initialTasks <span class="token operator">=</span> <span class="token punctuation">[</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    content<span class="token operator">:</span> <span class="token string">&quot;Wash the dishes&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    important<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    content<span class="token operator">:</span> <span class="token string">&quot;Take out the trash&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    important<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line">  <span class="token keyword">let</span> taskObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>initialTasks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">await</span> taskObject<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line">  taskObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>initialTasks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">await</span> taskObject<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token comment">// ...</span></code></pre></div>
<p>The database is cleared out at the beginning, and after that, we save the two tasks stored in the <code class="language-text">initialTasks</code> array to the database.
By doing this, <em>we ensure that the database is in the same state before every test is run</em>.</p>
<p>Let&#x27;s also make the following changes to our last two tests:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="gatsby-highlight-code-line"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;all tasks are returned&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">  <span class="token function">expect</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>initialTasks<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;a specific task is within the returned tasks&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> contents <span class="token operator">=</span> response<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token function">expect</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&quot;Take out the trash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><em>Pay special attention to the <code class="language-text">expect</code> in the latter test.</em>
The <code class="language-text">response.body.map(r =&gt; r.content)</code> command is used to create an array containing the content of every task returned by the API.
The <a href="https://jestjs.io/docs/expect#tocontainitem"><code class="language-text">toContain</code> method</a> is used for checking that the task given to it as a parameter is in the list of tasks returned by the API.</p>
<h3>Running tests one by one</h3>
<p>The <code class="language-text">npm test</code> command executes all of the tests for the application.
When we are writing tests, it is usually wise to only execute one or two tests.
Jest offers a few different ways of accomplishing this, one of which is the <a href="https://jestjs.io/docs/en/api#testonlyname-fn-timeout"><code class="language-text">only</code> method</a>.
If tests are written across many files, this method is not great.</p>
<p>A better option is to specify the tests that need to be run as parameters of the <code class="language-text">npm test</code> command.</p>
<p>The following command only runs the tests found in the <em>tests/task_api.test.js</em> file:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">npm test <span class="token operator">--</span> tests<span class="token operator">/</span>task_api<span class="token punctuation">.</span>test<span class="token punctuation">.</span>js</code></pre></div>
<p>The <code class="language-text">-t</code> option can be used for running tests with a specific name:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">npm test <span class="token operator">--</span> <span class="token operator">-</span>t <span class="token string">&#x27;a specific task is within the returned tasks&#x27;</span></code></pre></div>
<p>The provided parameter can refer to the name of the test or the <code class="language-text">describe</code> block.
<strong style="color:#6D5005"><em>The parameter can also contain just a part of the name.</em></strong>
<em>The following command will run all of the tests that contain <code class="language-text">tasks</code> in their name:</em></p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">npm test <span class="token operator">--</span> <span class="token operator">-</span>t <span class="token string">&#x27;tasks&#x27;</span></code></pre></div>
<blockquote>
<p><strong style="color:#6D5005">Notice</strong> When running a single test, the <strong style="color:#6D5005"><em>mongoose connection might stay open if no tests using the connection are run</em></strong> 🐞.
The problem might be because <em>supertest</em> primes the connection, but <em>Jest</em> does not run the <code class="language-text">afterAll</code> portion of the code.</p>
</blockquote>
<h3>async/await</h3>
<p>Before we write more tests let&#x27;s take a look at the <code class="language-text">async</code> and <code class="language-text">await</code> keywords.</p>
<p>The <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> syntax that was introduced in ES7 makes it possible to use <em>asynchronous functions that return a promise</em> in a way that makes the code look synchronous.</p>
<p>As an example, the fetching of tasks from the database with promises looks like this:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">Task<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">tasks</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;operation returned the following tasks&quot;</span><span class="token punctuation">,</span> tasks<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The <code class="language-text">Task.find()</code> method returns a promise and we can access the result of the operation by registering a callback function with the <code class="language-text">then</code> method.</p>
<p>All of the code we want to execute once the operation finishes is written in the callback function.
If we wanted to make several asynchronous function calls in sequence, the situation would soon become painful.
The asynchronous calls would have to be made in the callback.
This would likely lead to complicated code and could potentially give birth to a so-called <a href="http://callbackhell.com/"><strong style="color:#6D5005">callback hell</strong></a>.</p>
<p>By <a href="https://javascript.info/promise-chaining">chaining promises</a> we could keep the situation somewhat under control,
and avoid callback hell by creating a fairly clean chain of <code class="language-text">then</code> method calls.
We have seen a few of these during the course.
To illustrate this, you can view an artificial example of a function that <em>fetches all <code class="language-text">tasks</code> and then deletes the first one</em>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">Task<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">tasks</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> tasks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;the 1st task is removed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// more code here</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The <code class="language-text">then</code> chain is alright, but we can do better.
The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator"><strong style="color:#6D5005">generator functions</strong></a>
introduced in ES6 provided a <a href="https://github.com/getify/You-Dont-Know-JS/blob/1st-ed/async%20%26%20performance/ch4.md#iterating-generators-asynchronously">clever way</a>
of writing asynchronous code in a way that &quot;looks synchronous&quot;.
The syntax is a bit clunky and not widely used.</p>
<p>The <code class="language-text">async</code> and <code class="language-text">await</code> keywords introduced in ES7 bring the same functionality as the generators,
but in an understandable and syntactically cleaner way to the hands of all citizens of the JavaScript world.</p>
<p>We could fetch all of the tasks in the database by utilizing the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await"><code class="language-text">await</code> operator</a> like this:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;operation returned the following tasks&quot;</span><span class="token punctuation">,</span> tasks<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong style="color:#6D5005"><em>The code looks exactly like synchronous code</em></strong>.
The execution of code pauses at <code class="language-text">const tasks = await Task.find({})</code> and waits until the related promise is <strong style="color:#6D5005"><em>fulfilled</em></strong>, and then continues its execution to the next line.
When the execution continues, the result of the operation that returned a promise is assigned to the <code class="language-text">tasks</code> variable.</p>
<p>The slightly complicated example presented above could be implemented by using <code class="language-text">await</code> like this:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> tasks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;the 1st task is removed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Let&#x27;s see them side-by-side:</p>
<table>
<thead>
<tr>
<th align="left">.then</th>
<th align="left">.now</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><pre>Task.find({})<br/>  .then(tasks =&gt; {<br/>  })<br/>  .then(response =&gt; {<br/>    console.log(&quot;the 1st task is removed&quot;);<br/>    // more code here<br/>  });<br/></pre></td>
<td align="left"><pre>const tasks = await Task.find({});<br/>const response = await tasks[0].remove();<br/><br/>console.log(&quot;the 1st task is removed&quot;);<br/></pre></td>
</tr>
</tbody>
</table>
<p>Thanks to the new syntax, the <em>code is a lot simpler than the previous <code class="language-text">then</code> chain</em>.</p>
<p>There are a few important details to pay attention to when using <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> syntax.
To use the <code class="language-text">await</code> operator with asynchronous operations, they have to return a promise.
This is not a problem as such, as regular asynchronous functions using callbacks are easy to wrap around promises.</p>
<p>The <code class="language-text">await</code> keyword can&#x27;t be used just anywhere in JavaScript code.
Using <code class="language-text">await</code> is possible only inside of an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function"><code class="language-text">async</code> function</a>.</p>
<p>This means that <strong style="color:#6D5005"><em>for the previous examples to work, they have to be using <code class="language-text">async</code> functions</em></strong>.
Notice the first line in the arrow function definition:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="gatsby-highlight-code-line"><span class="token keyword">const</span> <span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>  <span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;operation returned the following tasks&quot;</span><span class="token punctuation">,</span> tasks<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> tasks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;the first task is removed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line"><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre></div>
<p>The code declares that the function assigned to <code class="language-text">main</code> is asynchronous.
After this, the code calls the function with <code class="language-text">main()</code>.</p>
<h3>async/await in the backend</h3>
<p>Let&#x27;s start to change the backend to <code class="language-text">async</code> and <code class="language-text">await</code>.
As all of the asynchronous operations are currently done inside of a function,
it is enough to change the route handler functions into <code class="language-text">async</code> functions.</p>
<p>The route in <em>controllers/tasks.js</em> for fetching all <code class="language-text">tasks</code> gets changed to the following:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>We can verify that our refactoring was successful by testing the endpoint through the browser and by running the tests that we wrote earlier.</p>
<p>You can find the code for our current application in its entirety in the <em>part4-3</em> branch of
<a href="https://github.com/comp227/part3-tasks-backend/tree/part4-3">this GitHub repository</a>.</p>
<h3>More tests and refactoring the backend</h3>
<p>When code gets refactored, there is always the risk of <a href="https://en.wikipedia.org/wiki/Regression_testing"><strong style="color:#6D5005">regression</strong></a>,
meaning that <em>existing functionality may break</em>.</p>
<p>Let&#x27;s refactor the remaining operations by first writing a test for each route of the API.
Start with the <em>add task</em> operation.</p>
<p><em>Write a new test</em> in <em>task_api.test.js</em> that:</p>
<ul>
<li>adds a new task</li>
<li>verifies that the number of tasks returned by the API increases</li>
<li>verifies the newly added task is in the list.</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;a valid task can be added&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
    content<span class="token operator">:</span> <span class="token string">&quot;async/await simplifies making async calls&quot;</span><span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> api
    <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>newTask<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> contents <span class="token operator">=</span> response<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>initialTasks<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>
    <span class="token string">&quot;async/await simplifies making async calls&quot;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Our test fails since we are by accident returning the status code <strong style="color:#6D5005"><em>200 OK</em></strong> when a new task is created.
Let us change that to <strong style="color:#6D5005"><em>201 CREATED</em></strong> in <em>controllers/tasks.js</em>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> body <span class="token operator">=</span> request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>

  <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    content<span class="token operator">:</span> body<span class="token punctuation">.</span>content<span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span>important<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  task<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">savedTask</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">      response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>savedTask<span class="token punctuation">)</span><span class="token punctuation">;</span></span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token function">next</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Let&#x27;s also add a test that verifies that a task without content will not be saved into the database.</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;task without content is not added&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
    important<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> api
    <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>newTask<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>initialTasks<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Both tests check the state stored in the database after the saving operation, by fetching all the tasks of the application.</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The same verification steps will repeat in other tests later on, and it is a good idea to extract these steps into helper functions.
Let&#x27;s add the function into a new file called <em>tests/test_helper.js</em> which is in the same directory as the test file.</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> Task <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../models/task&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> initialTasks <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    content<span class="token operator">:</span> <span class="token string">&quot;Wash the dishes&quot;</span><span class="token punctuation">,</span>
    date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    content<span class="token operator">:</span> <span class="token string">&quot;Take out the trash&quot;</span><span class="token punctuation">,</span>
    date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">nonExistingId</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">{</span> content<span class="token operator">:</span> <span class="token string">&quot;willremovethissoon&quot;</span><span class="token punctuation">,</span> date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> task<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> task<span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> task<span class="token punctuation">.</span>_id<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">tasksInDb</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> tasks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">task</span> <span class="token operator">=&gt;</span> task<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  initialTasks<span class="token punctuation">,</span> nonExistingId<span class="token punctuation">,</span> tasksInDb
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>The module defines the <code class="language-text">tasksInDb</code> function that can be used for checking the tasks stored in the database.
The <code class="language-text">initialTasks</code> array containing the initial database state is also in the module.
We also define the <code class="language-text">nonExistingId</code> function ahead of time,
which can be used for creating a database object ID that does not belong to any task object in the database.</p>
<p>Our <em>task_api.test.js</em> can now use the helper module and be changed like this:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> supertest <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;supertest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> helper <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./test_helper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token function">supertest</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Task <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../models/task&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">let</span> taskObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token keyword">await</span> taskObject<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  taskObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token keyword">await</span> taskObject<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;tasks are returned as json&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> api
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;all tasks are returned&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token function">expect</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;a specific task is within the returned tasks&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> contents <span class="token operator">=</span> response<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>
    <span class="token string">&quot;Take out the trash&quot;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;a valid task can be added &quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
    content<span class="token operator">:</span> <span class="token string">&quot;async/await simplifies making async calls&quot;</span><span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> api
    <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>newTask<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> tasksAtEnd <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token function">expect</span><span class="token punctuation">(</span>tasksAtEnd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> contents <span class="token operator">=</span> tasksAtEnd<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=&gt;</span> t<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token function">expect</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>
    <span class="token string">&quot;async/await simplifies making async calls&quot;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;task without content is not added&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
    important<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> api
    <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>newTask<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> tasksAtEnd <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line">  <span class="token function">expect</span><span class="token punctuation">(</span>tasksAtEnd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The code using promises works and the tests pass.
We are ready to refactor our code to use the <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> syntax.</p>
<p>Change the code in <em>controllers/tasks.js</em> that adds a new <code class="language-text">task</code> (notice that the route handler definition is preceded by the <code class="language-text">async</code> keyword):</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> body <span class="token operator">=</span> request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>

  <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    content<span class="token operator">:</span> body<span class="token punctuation">.</span>content<span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span>important<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> savedTask <span class="token operator">=</span> <span class="token keyword">await</span> task<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>savedTask<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>There&#x27;s a slight problem with our code: <em>we don&#x27;t handle error situations</em>.
<strong style="color:#6D5005"><em>How should we deal with them?</em></strong></p>
<h3>Error handling and async/await</h3>
<p>Luckily, we&#x27;ve built enough tests at this point that if we try to run our tests, jest will let us know that something is wrong as our test fails.</p>
<picture><img style="border-color:#F7F382" alt="test failing saying content is required" src="/static/8bf343ba8fe9bd64a3c6fec962fffc75/5a190/6.png"/></picture>
<p>While this should be enough of an alarm, you could also manually test this, by running the program and merely pressing save without any content.
Once you do this, you&#x27;ll get a nice stack trace and the server will even crash afterwards.</p>
<picture><img style="border-color:#F7F382" alt="terminal showing unhandled promise rejection warning" src="/static/c732d382ebc8c4d6f4217ddbfdbe0cda/5a190/exception_from_6.png"/></picture>
<p>What is happening? Well, we end up with an unhandled promise rejection, and the request never receives a response.</p>
<p>With <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> the recommended way of dealing with exceptions is the old and familiar <em>try/catch</em> mechanism:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> body <span class="token operator">=</span> request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>

  <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    content<span class="token operator">:</span> body<span class="token punctuation">.</span>content<span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span>important<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> savedTask <span class="token operator">=</span> <span class="token keyword">await</span> task<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">    response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>savedTask<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    <span class="token function">next</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The catch block simply calls the <code class="language-text">next</code> function, which passes the request handling to the error handling middleware.</p>
<p>After making the change, all of our tests will pass once again.</p>
<p>Next, let&#x27;s write tests for fetching and removing an individual task:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;a specific task can be viewed&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> tasksAtStart <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> taskToView <span class="token operator">=</span> tasksAtStart<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> resultTask <span class="token operator">=</span> <span class="token keyword">await</span> api</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/tasks/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>taskToView<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
  <span class="token function">expect</span><span class="token punctuation">(</span>resultTask<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>taskToView<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;a task can be deleted&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> tasksAtStart <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> taskToDelete <span class="token operator">=</span> tasksAtStart<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">await</span> api</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/tasks/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>taskToDelete<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
  <span class="token keyword">const</span> tasksAtEnd <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>tasksAtEnd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>
    helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> contents <span class="token operator">=</span> tasksAtEnd<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>taskToDelete<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Both tests share a similar structure.
In the initialization phase, they fetch a task from the database.
After this, the tests call the actual operation being tested.
Lastly, the tests verify that the outcome of the operation is as expected.</p>
<p>In the first test, the <em>task</em> object we receive as the <em>response body</em> goes through JSON serialization and parsing.
This processing will turn the task object&#x27;s <code class="language-text">date</code> property value&#x27;s type from <code class="language-text">Date</code> object into a <code class="language-text">string</code>.
Because of this we can&#x27;t directly compare the equality of the <code class="language-text">resultTask.body</code> and <code class="language-text">taskToView</code> that is read from the database.
Instead, we must first perform similar JSON serialization and parsing for the <code class="language-text">taskToView</code> as the server is performing for the task object.</p>
<p>The tests pass and now that we have some coverage for that code, we can refactor the tested routes to use <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/:id&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">next</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;/:id&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">next</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>You can find the code for our current application in its entirety in the <em>part4-4</em> branch of
<a href="https://github.com/comp227/part3-tasks-backend/tree/part4-4">this GitHub repository</a>.</p>
<h3>Eliminating the try-catch</h3>
<p><em>Async/await</em> unclutters the code, though at the expense of requiring the <code class="language-text">try</code>/<code class="language-text">catch</code> structure for catching exceptions.
All of the route handlers follow the same structure</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token comment">// do the async operations here</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>One starts to wonder if it would be possible to refactor the code to eliminate the <em>catch</em> from the methods?</p>
<p>The <a href="https://github.com/davidbanham/express-async-errors"><em>express-async-errors</em> library</a> has a solution for this.</p>
<p>Let&#x27;s install the library</p>
<div class="gatsby-highlight" data-language="bash"><pre><code class="language-bash"><span class="token function">npm</span> i express-async-errors</code></pre></div>
<p>Using the library requires minimal changes.
You introduce the library in <em>app.js</em> <strong style="color:#6D5005"><em>before</em></strong> you import your routes:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./utils/config&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express-async-errors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> tasksRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./controllers/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> middleware <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./utils/middleware&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./utils/logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> app<span class="token punctuation">;</span></code></pre></div>
<p>The <em>&#x27;magic&#x27;</em> of the library allows us to eliminate the <em><code class="language-text">try</code></em>/<em><code class="language-text">catch</code></em> blocks completely.
For example, our code for deleting a task in <em>controller/tasks.js</em>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;/:id&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">next</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>changes to:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;/:id&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Because of the library, we do not need the <code class="language-text">next(exception)</code> call anymore.
<strong style="color:#6D5005"><em>The library handles everything under the hood.</em></strong>
If an exception occurs in an <code class="language-text">async</code> route, the execution is automatically passed to the error-handling middleware.</p>
<p>The other routes become:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> body <span class="token operator">=</span> request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>

  <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    content<span class="token operator">:</span> body<span class="token punctuation">.</span>content<span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span>important<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> savedTask <span class="token operator">=</span> <span class="token keyword">await</span> task<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>savedTask<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">tasksRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/:id&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3>Optimizing the beforeEach function</h3>
<p>Let&#x27;s return to <em>task_api.test.js</em> and take a closer look at the <code class="language-text">beforeEach</code> function that sets up the tests:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> taskObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> taskObject<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  taskObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> taskObject<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The function saves the first two tasks from the <code class="language-text">helper.initialTasks</code> array into the database with two separate operations.
The solution is alright, but there&#x27;s a more elegant way of saving multiple objects to the database:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;cleared&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">task</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> taskObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> taskObject<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;saved&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;done&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;tasks are returned as json&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;entered test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>We save the tasks stored in the array into the database inside of a <code class="language-text">forEach</code> loop.
The tests don&#x27;t quite seem to work however.
<em>Imagine someone else added some console logs and wants your help to find the problem.</em></p>
<p>The console displays the following output:</p>
<div class="gatsby-highlight" data-language="shell"><pre><code class="language-shell">cleared
<span class="token keyword">done</span>
entered <span class="token builtin class-name">test</span>
saved
saved</code></pre></div>
<p>Aside from sharing with them our clog template, we look closer at the issue.
Despite our use of the async/await syntax, our solution does not work as we expected it to.
From the logs, we notice the test execution begins before the database is initialized!</p>
<p>The problem is that <strong style="color:#6D5005"><em>every iteration of the forEach loop generates an asynchronous operation</em></strong>, and <code class="language-text">beforeEach</code> won&#x27;t wait for them to finish executing.
In other words, the <code class="language-text">await</code> commands defined inside of the <code class="language-text">forEach</code> loop are not in the <code class="language-text">beforeEach</code> function, but in <strong style="color:#6D5005"><em>separate functions that <code class="language-text">beforeEach</code> will not wait for</em></strong>.</p>
<p>Since the execution of tests begins immediately after <code class="language-text">beforeEach</code> has finished executing,
the execution of tests begins before the database state is initialized.</p>
<p>One way of fixing this is to wait for all of the asynchronous operations to finish executing with the
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all"><code class="language-text">Promise.all</code> method</a>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> taskObjects <span class="token operator">=</span> helper<span class="token punctuation">.</span>initialTasks
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">task</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> promiseArray <span class="token operator">=</span> taskObjects<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">task</span> <span class="token operator">=&gt;</span> task<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>promiseArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The solution is quite advanced despite its compact appearance.
The <code class="language-text">taskObjects</code> variable is assigned to an array of Mongoose objects that are created with the <code class="language-text">Task</code> constructor for each of the tasks in the <code class="language-text">helper.initialTasks</code> array.
The next line of code creates a new array that <strong style="color:#6D5005">consists of promises</strong>,
that are created by calling the <code class="language-text">save</code> method of each item in the <code class="language-text">taskObjects</code> array.
In other words, it is an array of promises for saving each of the items to the database.</p>
<p><code class="language-text">Promise.all</code> can be used for transforming an array of promises into a single promise,
that will be <strong style="color:#6D5005"><em>fulfilled</em></strong> once every promise in the array passed to it as a parameter is resolved.
The last line of code <code class="language-text">await Promise.all(promiseArray)</code> waits until every promise for saving a task is finished, meaning that the database has been initialized.</p>
<blockquote>
<p>The returned values of each promise in the array can still be accessed when using the <code class="language-text">Promise.all</code> method.
If we wait for the promises to be resolved with the <code class="language-text">await</code> syntax <code class="language-text">const results = await Promise.all(promiseArray)</code>,
the operation will return an array that contains the resolved values for each promise in the <code class="language-text">promiseArray</code>,
and they appear in the same order as the promises in the array.</p>
</blockquote>
<p><code class="language-text">Promise.all</code> executes the promises it receives in parallel.
<em>If the promises need to be executed in a particular order, this will be problematic.</em>
In situations like this, the operations can be executed inside of a
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of"><code class="language-text">for</code>...<code class="language-text">of</code> block</a>,
that guarantees a specific execution order.</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> task <span class="token keyword">of</span> helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> taskObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> taskObject<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<blockquote>
<p><strong style="color:#6D5005">FYI:</strong> Score another a point for the use of the IDE, if you started with our original <code class="language-text">forEach</code> loop, WebStorm will flag this as a warning.
It then provides you the option to change it automatically to use the <code class="language-text">for</code>...<code class="language-text">of</code> syntax we&#x27;ve just explained here.
<strong style="color:#6D5005"><em>Make sure to look at the warnings!</em></strong></p>
</blockquote>
<p>The asynchronous nature of JavaScript can lead to surprising behavior, and for this reason,
it is important to pay careful attention when using the <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> syntax.
Even though the syntax makes it easier to deal with promises, <strong style="color:#6D5005">it is still necessary to understand how promises work</strong>!</p>
<p>The code for our application can be found on
<a href="https://github.com/comp227/part3-tasks-backend/tree/part4-5">GitHub</a>, branch <em>part4-5</em>.</p>
<h3>Web developers pledge v4</h3>
<p>We will once again update
<a href="/part3/saving_data_to_mongo_db#web-developers-pledge-v3">our web developer pledge</a>
but will also add another item, since last time we pledged to check the database:</p>
<blockquote>
<p>I also pledge to:</p>
<ul>
<li><em>Check that my code works when one of my tests does not pass</em></li>
</ul>
</blockquote>
</div></div>
<div class="banner spacing tasks content-banner" style="background-color:#fbfac7;border-color:#F7F382"><div class="course-content " style="border-color:#F7F382;background-color:transparent"><div class="course-content-inner ">
<h3>Exercises 4.8-4.12</h3>
<blockquote>
<p><strong style="color:#6D5005">Pertinent:</strong> the material uses the <a href="https://jestjs.io/docs/expect#tocontainitem"><code class="language-text">toContain</code> matcher</a> in several places
to verify that an array contains a specific element.
It&#x27;s worth noting that the method uses the <code class="language-text">===</code> operator for comparing and matching elements, which means that it is often not well suited for matching objects.
In most cases, the appropriate method for verifying objects in arrays is the <a href="https://jestjs.io/docs/expect#tocontainequalitem"><code class="language-text">toContainEqual</code></a> matcher.
However, the model solutions don&#x27;t check for objects in arrays with matchers, so using the method is not required for solving the exercises.</p>
</blockquote>
<p><strong style="color:#6D5005">Warning:</strong> If you find yourself <strong style="color:#6D5005"><em>using <code class="language-text">async</code>/<code class="language-text">await</code> and <code class="language-text">then</code> methods</em></strong> in the same code, it is almost guaranteed that <strong style="color:#6D5005">you are doing something wrong</strong>.
Use one or the other and don&#x27;t mix the two.</p>
<h4>4.8: Watchlist tests, Step 1</h4>
<p>Use the <em>supertest</em> package for writing a test that makes an <strong style="color:#6D5005">HTTP GET</strong> request to the <strong style="color:#6D5005"><em>/api/show</em></strong> URL.
Verify that the watchlist application returns the correct amount of streaming shows in the JSON format.</p>
<p>Once the test is finished, refactor the route handler to use the <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> syntax instead of promises.</p>
<p>Notice that you will have to make similar changes to the code that were made
<a href="#specifying-application-modes">in the material</a>,
like defining the test environment so that you can write tests that use separate databases.</p>
<blockquote>
<p><strong style="color:#6D5005">FYI:</strong> If you run into the following warning:</p>
<picture><img style="border-color:#F7F382" alt="Warning to read docs on connecting mongoose to jest" src="/static/e8bcb367be162a9be3c71b7f47d855a2/5a190/8a.png"/></picture>
<p><em>Please revisit <a href="#mongoose-related-warnings">the earlier section</a></em>
to follow the directions for adding a <em>tests/teardown.js</em> file and updating Jest definitions in <em>package.json</em>.</p>
<blockquote>
<p><strong style="color:#6D5005">Pertinent:</strong> when you are writing your tests <strong style="color:#6D5005"><em>it is better to not execute all of your tests</em></strong>, only execute the ones you are working on.
Read more about this <a href="#running-tests-one-by-one">here</a>.</p>
</blockquote>
</blockquote>
<h4>4.9*: Watchlist tests, Step 2</h4>
<p>Write a test that verifies that the unique identifier property of the shows is named <code class="language-text">id</code>, by default the database names the property <code class="language-text">_id</code>.
Verifying the existence of a property is easily done with Jest&#x27;s <a href="https://jestjs.io/docs/en/expect#tobedefined"><code class="language-text">toBeDefined</code> matcher</a>.</p>
<p>Make the required changes to the code so that it passes the test.
The <a href="/part3/saving_data_to_mongo_db#backend-connected-to-a-database"><code class="language-text">toJSON</code> method</a> discussed in part 3
is an appropriate place for defining the <code class="language-text">id</code> parameter.</p>
<h4>4.10: Watchlist tests, Step 3</h4>
<p>Write a test that verifies that making an <strong style="color:#6D5005">HTTP POST</strong> request to the <strong style="color:#6D5005"><em>/api/shows</em></strong> URL successfully creates a new show onto the list.
At the very least, verify that the total number of shows in the system is increased by one.
You can also verify that the show JSON object is saved correctly to the database.</p>
<p>Once the test is finished, refactor the operation to use <em><code class="language-text">async</code></em>/<em><code class="language-text">await</code></em> instead of promises.</p>
<h4>4.11*: Watchlist tests, Step 4</h4>
<p>Write a test that verifies that if the <code class="language-text">likes</code> property is missing from the request, it will default to the value <em><code class="language-text">0</code></em>.
Do not test the other properties of the created shows yet.</p>
<p>Make the required changes to the code so that it passes the test.</p>
<h4>4.12*: Watchlist tests, Step 5</h4>
<p>Write a test related to creating new shows via the <strong style="color:#6D5005"><em>/api/shows</em></strong> endpoint,
that verifies that if the <code class="language-text">title</code> or <code class="language-text">url</code> properties are missing from the request data,
the backend responds to the request with the status code <strong style="color:#6D5005">400 Bad Request</strong>.</p>
<p>Make the required changes to the code so that it passes the test.</p>
</div></div></div>
<div class="course-content "><div class="course-content-inner ">
<h3>Refactoring tests</h3>
<p>Our test coverage is currently lacking.
Some requests like <strong style="color:#6D5005"><em>GET /api/tasks/:id</em></strong> and <strong style="color:#6D5005"><em>DELETE /api/tasks/:id</em></strong> aren&#x27;t tested when the request is sent with an invalid id.
The grouping and organization of tests could also use some improvement, as all tests exist on the same &quot;top level&quot; in the test file.
The readability of the test would improve if we group related tests with <code class="language-text">describe</code> blocks.</p>
<p>Below is an example of <em>task_api.test.js</em> after making some minor improvements:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> supertest <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;supertest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> helper <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./test_helper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token function">supertest</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Task <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../models/task&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">insertMany</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;when there is initially some tasks saved&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;tasks are returned as json&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> api
      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;all tasks are returned&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;a specific task is within the returned tasks&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> contents <span class="token operator">=</span> response<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>
      <span class="token string">&quot;Take out the trash&quot;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;viewing a specific task&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;succeeds with a valid id&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> tasksAtStart <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> taskToView <span class="token operator">=</span> tasksAtStart<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> resultTask <span class="token operator">=</span> <span class="token keyword">await</span> api
      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/tasks/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>taskToView<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
    <span class="token function">expect</span><span class="token punctuation">(</span>resultTask<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>taskToView<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;fails with statuscode 404 if task does not exist&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> validNonexistingId <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">nonExistingId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> api
      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/tasks/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>validNonexistingId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;fails with statuscode 400 if id is invalid&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> invalidId <span class="token operator">=</span> <span class="token string">&quot;5a3d5da59070081a82a3445&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> api
      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/tasks/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invalidId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;addition of a new task&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;succeeds with valid data&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
      content<span class="token operator">:</span> <span class="token string">&quot;async/await simplifies making async calls&quot;</span><span class="token punctuation">,</span>
      important<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">await</span> api
      <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>newTask<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> tasksAtEnd <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>tasksAtEnd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> contents <span class="token operator">=</span> tasksAtEnd<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=&gt;</span> t<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>
      <span class="token string">&quot;async/await simplifies making async calls&quot;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;fails with status code 400 if data invalid&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
      important<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">await</span> api
      <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/tasks&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>newTask<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> tasksAtEnd <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>tasksAtEnd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;deletion of a task&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;succeeds with status code 204 if id is valid&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> tasksAtStart <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> taskToDelete <span class="token operator">=</span> tasksAtStart<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">await</span> api
      <span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/tasks/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>taskToDelete<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> tasksAtEnd <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">tasksInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>tasksAtEnd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>
      helper<span class="token punctuation">.</span>initialTasks<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> contents <span class="token operator">=</span> tasksAtEnd<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>taskToDelete<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The test output is grouped according to the <code class="language-text">describe</code> blocks:</p>
<picture><img style="border-color:#F7F382" alt="jest output showing grouped describe blocks" src="/static/238c0372a6745cacea9e79ca3ff8e548/5a190/7.png"/></picture>
<p>There is still room for improvement, but it is time to move forward.</p>
<p>This way of testing the API, by making HTTP requests and inspecting the database with Mongoose,
is by no means the only nor the best way of conducting API-level integration tests for server applications.
<strong style="color:#6D5005"><em>There is no universal best way of writing tests</em></strong>, as it all depends on the application being tested and available resources.</p>
<p>You can find the code for our current application in its entirety in the <em>part4-6</em> branch of
<a href="https://github.com/comp227/part3-tasks-backend/tree/part4-6">this GitHub repository</a>.</p>
</div></div>
<div class="banner spacing tasks content-banner" style="background-color:#fbfac7;border-color:#F7F382"><div class="course-content " style="border-color:#F7F382;background-color:transparent"><div class="course-content-inner ">
<h3>Exercises 4.13-4.14</h3>
<h4>4.13 Watchlist expansions, Step 1</h4>
<p>Implement functionality for deleting a single show.</p>
<p>Use the async/await syntax.
Follow <a href="/part3/node_js_and_express#rest">RESTful conventions</a> when defining the HTTP API.</p>
<p>Implement tests for the functionality.</p>
<h4>4.14 Watchlist expansions, Step 2</h4>
<p>Implement functionality for updating the information of an individual show.</p>
<p>Use <code class="language-text">async</code>/<code class="language-text">await</code>.</p>
<p>The application mostly needs to update the number of <strong style="color:#6D5005"><em>likes</em></strong> for a show.
You can implement this functionality the same way that we implemented updating tasks in <a href="/part3/saving_data_to_mongo_db#other-operations">part 3</a>.</p>
<p>Implement tests for the functionality.</p>
</div></div></div></div></div><div class="container spacing element--flex element--centered"><a class="edit-link" target="__BLANK" href="https://github.com/comp227/comp227/edit/source/src/content/4/en/part4b.md"><span>Propose changes to material</span></a></div><div class="container spacing spacing--after-large prev-next__container "><a class="col-4--mobile push-right-1 prev" href="/part4/structure_of_backend_application_introduction_to_testing"><div class=" element--flex element--column"><p>Part<!-- --> <!-- -->4a</p><b>Previous part</b></div></a><div class="col-1--mobile separator"></div><a class="col-4--mobile push-left-1 next" href="/part4/user_administration"><div class=" element--flex element--column"><p>Part<!-- --> <!-- -->4c</p><b>Next part</b></div></a></div></div></main><footer class="container spacing--after-small spacing--mobile element--flex" id="footer"><div class="col-10 push-right-1 col-10--mobile order-2--mobile order-2--tablet footer__links element--flex element--space-between"><a href="https://www.helsinki.fi/" class="col-3 col-4--mobile spacing--mobile"><div class="image col-6 image--contain image--invert"><div class="image__container"><img style="background-color:;background-opacity:0.5" class="image__content" src="/static/uoh_centre-3689cf9983a2ebc8089c8f078a9c4769.svg" alt="Helsingin yliopiston logo"/></div></div></a><a href="http://www.pacific.edu" class="col-3 col-4--mobile spacing--mobile"><div class="image col-6 image--contain image--invert"><div class="image__container"><img style="background-color:;background-opacity:0.5" class="image__content" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSIzMDAuMSIgaGVpZ2h0PSI4Ny42NSI+CiAgPHBhdGggZmlsbD0iIzIxMjMyMiIgZD0iTTE0LjE0IDIuMzhjMC0uODEtLjI2LTEuNTYtMS4zLTEuNTZWLjM2Yy44IDAgMS41OC4xIDIuMzYuMS44OCAwIDEuNjYtLjEgMi4zMS0uMXYuNDdjLS44OCAwLTEuMTQuNzUtMS4xNCAxLjU2bC0uMDcgMTQuMDZjMCAxLjA5LjYyIDEuNTUgMS41IDEuNTV2LjQ3Yy0uNjUgMC0xLjMtLjEtMS45NS0uMS0uNjUgMC0xLjMuMS0xLjk1LjF2LS4xOGMuMTYtLjE2LjI2LS4zOS4yNi0uN3YtMS4yN2MtMS43OSAxLjIyLTMuNzYgMi40Ny02LjIgMi40Ny0zLjg0IDAtNi40OS0yLjQ0LTYuNDktNi42NEwxLjQgMi4zOEMxLjQgMS41NyAxLjA0LjgyLjA1LjgyVi4zNmMuODMgMCAxLjYxLjEgMi40MS4xLjg4IDAgMS42Ni0uMSAyLjQxLS4xdi40N2MtLjk5IDAtMS4yNS43NS0xLjI1IDEuNTZsLS4wOCA5LjY2YzAgNC4xIDIuODYgNS40IDQuOTMgNS40IDIuMDMgMCA0LjcyLS44MyA1Ljc0LTIuNDdsLS4wNy0xMi42TTI1LjA3LjM2djE1LjYzYzAgMS4zMi0uMzEgMS42OS0xLjY0IDIuMDJ2LjQ3Yy42NSAwIDEuNC0uMSAyLjM5LS4xLjc1IDAgMS41MS4xIDIuMzYuMXYtLjQ3Yy0xLjUxLS4zMy0xLjgyLS43LTEuODItMy40MnYtOS45TDM5LjcgMTguNDdoLjU3VjIuODVjMC0xLjMyLjMxLTEuNjkgMS43MS0yLjAyVi4zNmMtLjc1IDAtMS41LjEtMi4yNi4xLS43NSAwLTEuNTEtLjEtMi41Mi0uMXYuNDdjMS42OS4zNCAyIC43IDIgNS4yNHY4LjU2TDI4LjA4IDMuMTFjLS44Ni0uODgtMS42MS0xLjg3LTIuNDQtMi43NWgtLjU3bTI3LjQ4LjQ3Vi4zNmMtLjc4IDAtMS41Ni4xLTIuNDQuMS0uNzggMC0xLjU1LS4xLTIuMzYtLjF2LjQ3YzEuMDEgMCAxLjMuNzUgMS4zIDEuNTZsLjEzIDE0LjA3YzAgLjgtLjQyIDEuNTUtMS4xNCAxLjU1di40N2MuNTIgMCAxLjMtLjEgMi4wOC0uMS44OCAwIDEuNjYuMSAyLjIxLjF2LS40N2MtLjc4IDAtMS4xOS0uNzUtMS4xOS0xLjU1bC4xMy0xNC4wN2MtLjAyLS44MS4yNy0xLjU2IDEuMjgtMS41Nm0xMi4zNiAxNy45NmguN2w2Ljk4LTE2LjUxYy40Mi0uOTkuNy0xLjM1IDEuNjEtMS40NVYuMzZjLS43OCAwLTEuNTMuMS0yLjI4LjEtLjc1IDAtMS41LS4xLTIuMjYtLjF2LjQ3Yy44OC4xMyAxLjEyLjM0IDEuMTIgMS4xNCAwIC4xNi0uMDUuOTYtLjM0IDEuNzFsLTQuNzIgMTEuODEtNC42NS0xMy4xNmMtLjIxLS42LS4yOS0uODgtLjI5LTEuMDQgMC0uMjYuNy0uNDEuOTYtLjQ3Vi4zNmMtLjggMC0xLjYxLjEtMi40MS4xcy0xLjYxLS4xLTIuNDEtLjF2LjQ3Yy43My4xLjg4LjE4IDEuMyAxLjIybDYuNjkgMTYuNzRtMjQuODEtMTUuNlYuMDVoLS40N2MtLjEzLjI2LS4yOS40Mi0uODYuNDJINzguMDZ2LjQ3YzEuMzUuMDUgMS40Ni4yNiAxLjQ2IDguM3Y3LjIyYzAgMS4xNC0uMzkgMS41LTEuNDYgMS41NXYuMzdoOC4zNmMxLjY2IDAgMi41NC4wNSAzLjQ1LjIzbC4zOS0yLjgzLS40MS0uMDhjLS40NyAxLjA0LTEuMiAxLjc5LTIuODYgMS43OWgtNS40VjkuNjJoNC41NGMxLjQ1IDAgMS45NS4zNCAyLjIzIDEuM2guNDdjLS4wMy0uNTctLjA4LTEuMTctLjA4LTEuNzYgMC0uNi4wNS0xLjE5LjA4LTEuNzRoLS40N2MtLjI5Ljk5LS43OCAxLjMyLTIuMjMgMS4zMmgtNC41NFY2LjEyYzAtMS41My4wNS0zLjYzLjIxLTQuNzhoNC4wNWMyLjE4IDAgMy4xNC42OCAzLjQgMS44NGguNDdNOTkuNCA5LjdWNS41OGMwLTEuMTIuMS0yLjUyLjEtMy43MSAwLS44My4yMS0uODggMS4yNS0uODggMi45NiAwIDQuNTcgMiA0LjU3IDQuNTQgMCAyLjYyLTEuODcgNC4zMy00LjcyIDQuMzMtLjQ4IDAtLjg5LS4xLTEuMi0uMTZtLTIuMDggNi43NWMwIC44LS4zNCAxLjU1LTEuMjIgMS41NXYuNDdjLjY1IDAgMS40My0uMSAyLjIxLS4xLjg4IDAgMS42Ni4xIDIuMzEuMVYxOGMtLjg4IDAtMS4yMi0uNzUtMS4yMi0xLjU1di01LjkyYzEuMjQuMTMgMi4wNS43MyAyLjY3IDEuNDhsNC40NCA1LjRjLjEuMTMuMjEuMzQuMjEuNDIgMCAuMDUtLjEzLjEzLS4yMS4xOHYuNDdjLjY4IDAgMS4zNS0uMSAyLjAyLS4xLjY4IDAgMS4zNS4xIDIuMDMuMXYtLjQ3Yy0uNjItLjIxLTEuMDktLjQxLTEuNjQtMS4wNmwtNS43NC02LjY3YzIuMjMtLjU3IDQuMzktMi4yOCA0LjM5LTQuNyAwLTQuMDItMy4zNS01LjM3LTYuOTMtNS4zNy0xLjM4IDAtMy42MS4xNi00Ljg1LjE2di40N2MxLjE0IDAgMS40My42NyAxLjQzIDIuMDIgMCAxLjg3LjEgNC4yMy4xIDYuNTd2Ny4wMnptMjcuNTktMTMuMTNoLjQ3bC0uMTEtMi45MWMtMS4zNS4wNS0yLjY1LS4zNi00LS4zNi0zLjQgMC02LjM2IDEuNTMtNi4zNiA1LjMgMCA2LjcgOS4xNiAzLjgyIDkuMTYgOS4zMiAwIDIuMjgtMS43OSAzLjMtMy44NCAzLjMtMS43NCAwLTMuODItLjc4LTQuNDEtMi42MmgtLjQ3bC4xIDIuN2MxLjYxLjQ3IDMuMjIuNzUgNC44Ljc1IDMuMTkgMCA1LjYzLTEuNzYgNS42My01LjE0IDAtNi4yLTkuMTYtMy43NC05LjE2LTkuMzIgMC0yLjM2IDIuMDItMy40NSA0LjEzLTMuNDUgMS42NS0uMDEgMy41MS43NCA0LjA2IDIuNDNNMTM2LjE1LjgzVi4zNmMtLjc4IDAtMS41Ni4xLTIuNDQuMS0uNzggMC0xLjU2LS4xLTIuMzYtLjF2LjQ3YzEuMDEgMCAxLjMuNzUgMS4zIDEuNTZsLjEzIDE0LjA3YzAgLjgtLjQyIDEuNTUtMS4xNCAxLjU1di40N2MuNTIgMCAxLjMtLjEgMi4wOC0uMS44OCAwIDEuNjYuMSAyLjIuMXYtLjQ3Yy0uNzggMC0xLjE5LS43NS0xLjE5LTEuNTVsLjEzLTE0LjA3Yy0uMDEtLjgxLjI3LTEuNTYgMS4yOS0xLjU2bTguNjYuN2gzLjY0bC4wOCAxNC45MmMwIC45Ni0uMzYgMS4yMi0xLjc5IDEuNTV2LjQ3Yy45MyAwIDEuODctLjEgMi44LS4xLjkzIDAgMS44Ny4xIDIuOC4xVjE4Yy0xLjM1LS4zMy0xLjc0LS41OS0xLjc0LTEuNTVsLjA4LTE0LjkyaDMuNjNjMS42OSAwIDIuMjYuNDQgMi43MyAxLjgyaC40N2wuMS0zLjNoLS4xM2MtLjQyLjE2LTEuMDQuMzEtMS41My4zMS0yLjEzIDAtNC4yNi4xLTYuMzguMS0yLjEzIDAtNC4yNi0uMS02LjM4LS4xLS40OSAwLTEuMTItLjE2LTEuNTMtLjMxaC0uMTNsLjEgMy4zaC40N2MuNDYtMS4zOCAxLjAzLTEuODIgMi43MS0xLjgybTI0LjIyIDguNTl2Ni4zM2MwIC44LS4zNCAxLjU1LTEuMzIgMS41NXYuNDdjLjc1IDAgMS41My0uMSAyLjMxLS4xLjg4IDAgMS42Ni4xIDIuMzYuMVYxOGMtLjk0IDAtMS4yNy0uNzUtMS4yNy0xLjU1VjkuNjJsMi40NC0zLjg3Yy45OS0xLjU2IDMuMjItNC40NiA0LjUyLTQuOTNWLjM2Yy0uNjcgMC0xLjM1LjEtMi4wMi4xLS42OCAwLTEuMzUtLjEtMi4wMy0uMXYuNDdjLjQyLjA1Ljg2LjE1Ljg2LjY3IDAgLjE4LS4xOC42NS0uNiAxLjI3bC0zLjg3IDYuMTgtMy43Ni02LjMzYy0uMjMtLjQyLS4zNC0uOC0uMzQtLjk2IDAtLjQ3LjM0LS43LjkzLS44M1YuMzZjLS44IDAtMS42MS4xLTIuNDEuMXMtMS42MS0uMS0yLjQxLS4xdi40N2MuNzUuMzEgMS40Ni45MSAyLjAzIDEuODdsNC41OCA3LjQybTMxLjM4IDcuODRjLTQuODYgMC02LjktMy43OS02LjktOC41NCAwLTQuNzUgMi4wNS04LjU0IDYuOS04LjU0IDQuODUgMCA2LjkgMy43OSA2LjkgOC41NCAwIDQuNzUtMi4wNSA4LjU0LTYuOSA4LjU0bS05LjM3LTguNTRjMCA1LjMyIDMuOTcgOS4zNyA5LjM3IDkuMzcgNS40IDAgOS4zNy00LjA1IDkuMzctOS4zN1MyMDUuODEuMDUgMjAwLjQxLjA1Yy01LjQgMC05LjM3IDQuMDUtOS4zNyA5LjM3em0yNy45NS0uNjh2LTcuNGg0LjMxYzEuMzMgMCAxLjc3LjY1IDEuODcgMS42OWguNDdWLjM2Yy0uODggMC0yLjAzLjEtMy41My4xaC02Ljg4di40N2MuOTMuMDUgMS4xNy4xOCAxLjIyLjQxLjE4Ljc4LjQ3IDIuODguNDcgNy4wOXY4LjA0YzAgLjgtLjM0IDEuNTYtMS4yMiAxLjU2di40N2MuNjUgMCAxLjQzLS4xIDIuMjEtLjEuODggMCAxLjY2LjEgMi4zMS4xdi0uNDdjLS44OCAwLTEuMjItLjc1LTEuMjItMS41NlY5LjYyaDMuNDVjMS40NSAwIDEuOTUuMzQgMi4yOCAxLjRoLjQ3Yy0uMDgtLjY3LS4xMy0xLjI3LS4xMy0xLjg3IDAtLjYuMDUtMS4xOS4wOC0xLjg0aC0uNDdjLS4yOCAxLjA5LS43OCAxLjQzLTIuMjMgMS40M2gtMy40Nm0yNS4wNy03LjIxaDMuNjNsLjA4IDE0LjkyYzAgLjk2LS4zNiAxLjIyLTEuNzkgMS41NXYuNDdjLjkzIDAgMS44Ny0uMSAyLjgtLjEuOTMgMCAxLjg3LjEgMi44LjFWMThjLTEuMzUtLjMzLTEuNzQtLjU5LTEuNzQtMS41NWwuMDgtMTQuOTJoMy42M2MxLjY5IDAgMi4yNi40NCAyLjcyIDEuODJoLjQ3bC4xLTMuM2gtLjEzYy0uNDIuMTYtMS4wNC4zMS0xLjUzLjMxLTIuMTMgMC00LjI2LjEtNi4zOC4xLTIuMTMgMC00LjI2LS4xLTYuMzgtLjEtLjQ5IDAtMS4xMi0uMTYtMS41My0uMzFoLS4xM2wuMTEgMy4zaC40N2MuNDYtMS4zOCAxLjAzLTEuODIgMi43Mi0xLjgybTIxLjMzIDguMDJoMTEuOTF2Ni45YzAgLjgtLjM0IDEuNTUtLjk2IDEuNTV2LjQ3Yy4zOSAwIDEuMTctLjEgMi4wNS0uMS43OCAwIDEuNTYuMSAxLjk1LjFWMThjLS42MiAwLTEuMDEtLjc1LTEuMDEtMS41NXYtOS41Yy4wMy01LjkyLjE4LTYuMjMgMS4yNy02LjEyVi4zNmMtLjY1IDAtMS40My4xLTIuMjEuMS0uODggMC0xLjY2LS4xLTIuMzEtLjF2LjQ3Yy44OCAwIDEuMTcuNzUgMS4xNyAxLjU2bC4wNSA2LjFoLTExLjkxbC4wNS02LjFjMC0uODEuMjgtMS41NiAxLjE3LTEuNTZWLjM2Yy0uNjUgMC0xLjQzLjEtMi4zMS4xLS43OCAwLTEuNTYtLjEtMi4yMS0uMXYuNDdjMS4wOS0uMSAxLjI0LjIxIDEuMjcgNi4xMnY5LjVjMCAuOC0uMzkgMS41NS0xLjAxIDEuNTV2LjQ3Yy4zOSAwIDEuMTctLjEgMS45NS0uMS44OCAwIDEuNjYuMSAyLjA1LjFWMThjLS42MiAwLS45Ni0uNzUtLjk2LTEuNTV2LTYuOW0zMi41Ny02LjM2Vi4wNWgtLjQ3Yy0uMTMuMjYtLjI4LjQyLS44Ni40MkgyODYuM3YuNDdjMS4zNS4wNSAxLjQ1LjI2IDEuNDUgOC4zdjcuMjJjMCAxLjE0LS4zOSAxLjUtMS40NSAxLjU1di4zN2g4LjM2YzEuNjYgMCAyLjU0LjA1IDMuNDUuMjNsLjM5LTIuODMtLjQxLS4wOGMtLjQ3IDEuMDQtMS4xOSAxLjc5LTIuODYgMS43OWgtNS40VjkuNjJoNC41NGMxLjQ2IDAgMS45NS4zNCAyLjIzIDEuM2guNDZjLS4wMy0uNTctLjA4LTEuMTctLjA4LTEuNzYgMC0uNi4wNS0xLjE5LjA4LTEuNzRoLS40NmMtLjI5Ljk5LS43OCAxLjMyLTIuMjMgMS4zMmgtNC41NFY2LjEyYzAtMS41My4wNS0zLjYzLjIxLTQuNzhoNC4wNWMyLjE4IDAgMy4xNC42OCAzLjQgMS44NGguNDciLz4KICA8cGF0aCBmaWxsPSIjMjEyMzIyIiBkPSJNMTEuMTQgNTUuODhjMCAxLjc4LjUxIDMuMyA2Ljc3IDMuMyA5Ljk4IDAgMTMuMDMtNi43NyAxMy4wMy0xNC44MSAwLTcuNTMtMi43OS0xNC42NC0xNC4wNC0xNC42NC00LjQgMC01LjQyLjUxLTUuNDIgNC4yMyAwIDEuNzgtLjM0IDUuNjctLjM0IDEwLjc0djExLjE4TTQuMjEgMzQuMTRjMC0yLjYyLTEuMS01LjA4LTQuMTUtNS4wOHYtMS41MmMzLjIyIDAgNi40My4zNCA5LjY0LjM0IDMuMjIgMCA2LjQzLS4zNCA5LjY1LS4zNCA4Ljk3IDAgMTguOTUgNC41NyAxOC45NSAxNyAwIDEwLjc0LTkuNzMgMTYuNjctMTkuMzcgMTYuNjctMi44OCAwLTUuNDItLjM0LTcuNzgtLjUxbC0uMTcgMTkuMjljMCAyLjYyIDEuMSA1LjA3IDMuOTggNS4wN3YxLjUyYy0yLjEyIDAtNC42NS0uMzQtNy41My0uMzQtMi41NCAwLTUuMDguMzQtNy4xOS4zNHYtMS41MmMyLjg4IDAgMy45OC0yLjQ1IDMuOTgtNS4wN1YzNC4xNHpNNDguMzcgNjYuMkg2OS42bC05Ljk4LTI3LjU4TDQ4LjM3IDY2LjJtLTEuMzYgMy40Ny0yLjcxIDcuNDVjLS41OSAxLjYxLS41OSAzLjcyLS41OSA0LjU3IDAgMS41MiAxLjUyIDIuNjIgMy42NCAzLjM4djEuNTJjLTIuMTEgMC00LjMxLS4zNC02LjQzLS4zNC0yLjIgMC00LjQuMzQtNy4wMi4zNHYtMS41MmM0LjIzLTEuMzUgNC44Mi0zLjM4IDYuMzUtNy4xMWwyMC40Ny01MS40NGgxLjQ0bDE4LjM2IDUxLjQ0YzEuNDQgNC4wNiAyLjYyIDUuNTggNi42OCA3LjExdjEuNTJjLTIuNTQgMC01LjA3LS4zNC03LjYxLS4zNHMtNS4wOC4zNC03LjYxLjM0di0xLjUyYzEuMS0uNzYgMi45Ni0xLjg2IDIuOTYtMi44OCAwLTEuMzYtLjUxLTIuNDYtLjkzLTMuNjRsLTMuMy04Ljg4aC0yMy43em05Mi44OSAxNS41N2MtNS4zMyAxLjUyLTEyLjUyIDIuMzctMTguMDIgMi4zNy0yMC4yMiAwLTMzLjY3LTEyLjM1LTMzLjY3LTMwLjU0IDAtMTguMTkgMTMuNDUtMzAuNTQgMzMuNjctMzAuNTQgNy42MSAwIDE1LjY1IDMuMDQgMTcuMzQgMy4wNC4zNCAwIC43Ni0uMzQgMS4xOS0uNDJsLjkzIDkuMDVoLTEuNTJjLTIuOTYtNi41MS0xMS41OS04Ljk3LTE3LjkzLTguOTctMTUuMTQgMC0yNS42NCA5Ljk4LTI1LjY0IDI3Ljg0IDAgMTIuNzcgMTEuNTEgMjcuODMgMjUuNjQgMjcuODMgMTAuMDcgMCAxNS44Mi0yLjU0IDE5Ljg4LTguOGwxLjEuNTktMi45NyA4LjU1bTI3LjE2LTU2LjE4Yy0zLjMgMC00LjIzIDIuNDUtNC4yMyA1LjA4bC0uNDIgNDUuODVjMCAyLjYyIDEuMzUgNS4wNyAzLjg5IDUuMDd2MS41MmMtMS43OCAwLTQuMzItLjM0LTcuMTktLjM0LTIuNTQgMC01LjA4LjM0LTYuNzcuMzR2LTEuNTJjMi4zNyAwIDMuNzItMi40NSAzLjcyLTUuMDdsLS40Mi00NS44NWMwLTIuNjItLjkzLTUuMDgtNC4yMy01LjA4di0xLjUyYzIuNjIgMCA1LjE2LjM0IDcuNy4zNCAyLjg3IDAgNS40MS0uMzQgNy45NS0uMzR2MS41Mm0yMi4yNSAyNS44aDExLjI1YzQuNzQgMCA2LjM1LTEuMSA3LjI3LTQuNjVoMS41M2MtLjA5IDIuMTEtLjI2IDQuMDYtLjI2IDYuMDFzLjE3IDMuODkuNDMgNi4wOWgtMS41MmMtMS4xLTMuNDctMi43MS00LjU3LTcuNDUtNC41N2gtMTEuMjV2MjIuMzRjMCAyLjYyIDEuMSA1LjA4IDMuOTcgNS4wOHYxLjUyYy0yLjEyIDAtNC42NS0uMzQtNy41My0uMzQtMi41NCAwLTUuMDguMzQtNy4xOS4zNHYtMS41MmMyLjg4IDAgMy45OC0yLjQ1IDMuOTgtNS4wOFY1My44NWMwLTEzLjcxLS45My0yMC41Ni0xLjUzLTIzLjEtLjE3LS43Ni0uOTMtMS4xOC0zLjk4LTEuMzV2LTEuNTJoMjIuNDJjNC45MSAwIDguNjMtLjM0IDExLjUtLjM0djguNzFoLTEuNTJjLS4zNC0zLjM4LTEuNzgtNS41LTYuMDktNS41SDE4OS4zdjI0LjExbTQ3LjMtMjUuOGMtMy4zIDAtNC4yMyAyLjQ1LTQuMjMgNS4wOGwtLjQyIDQ1Ljg1YzAgMi42MiAxLjM1IDUuMDcgMy44OSA1LjA3djEuNTJjLTEuNzggMC00LjMxLS4zNC03LjE5LS4zNC0yLjU0IDAtNS4wOC4zNC02Ljc3LjM0di0xLjUyYzIuMzcgMCAzLjcyLTIuNDUgMy43Mi01LjA3bC0uNDItNDUuODVjMC0yLjYyLS45My01LjA4LTQuMjMtNS4wOHYtMS41MmMyLjYyIDAgNS4xNi4zNCA3LjcuMzQgMi44OCAwIDUuNDEtLjM0IDcuOTUtLjM0djEuNTJtNjAuNDkgNTYuMThjLTUuMzMgMS41Mi0xMi41MiAyLjM3LTE4LjAyIDIuMzctMjAuMjIgMC0zMy42Ny0xMi4zNS0zMy42Ny0zMC41NCAwLTE4LjE5IDEzLjQ1LTMwLjU0IDMzLjY3LTMwLjU0IDcuNjEgMCAxNS42NSAzLjA0IDE3LjM0IDMuMDQuMzQgMCAuNzYtLjM0IDEuMTktLjQybC45MyA5LjA1aC0xLjUyYy0yLjk2LTYuNTEtMTEuNTktOC45Ny0xNy45NC04Ljk3LTE1LjE0IDAtMjUuNjMgOS45OC0yNS42MyAyNy44NCAwIDEyLjc3IDExLjUxIDI3LjgzIDI1LjYzIDI3LjgzIDEwLjA3IDAgMTUuODItMi41NCAxOS44OC04LjhsMS4xLjU5LTIuOTYgOC41NSIvPgo8L3N2Zz4=" alt="University of the Pacific"/></div></div></a><a href="https://www.houston-inc.com/" class="col-3 col-4--mobile spacing--mobile"><div class="image col-6 image--contain image--invert"><div class="image__container"><img style="background-color:;background-opacity:0.5" class="image__content" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgdmlld0JveD0iMCAwIDc5My43MDEzNSAxNTEuMDQ5MzMiCiAgIGhlaWdodD0iMTUxLjA0OTMzIgogICB3aWR0aD0iNzkzLjcwMTM1IgogICB4bWw6c3BhY2U9InByZXNlcnZlIgogICBpZD0ic3ZnMiIKICAgdmVyc2lvbj0iMS4xIj48bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGE4Ij48cmRmOlJERj48Y2M6V29yawogICAgICAgICByZGY6YWJvdXQ9IiI+PGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+PGRjOnR5cGUKICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIiAvPjwvY2M6V29yaz48L3JkZjpSREY+PC9tZXRhZGF0YT48ZGVmcwogICAgIGlkPSJkZWZzNiI+PGNsaXBQYXRoCiAgICAgICBpZD0iY2xpcFBhdGgxOCIKICAgICAgIGNsaXBQYXRoVW5pdHM9InVzZXJTcGFjZU9uVXNlIj48cGF0aAogICAgICAgICBpZD0icGF0aDE2IgogICAgICAgICBkPSJNIDAsMTEzLjI4NyBIIDU5NS4yNzYgViAwIEggMCBaIiAvPjwvY2xpcFBhdGg+PC9kZWZzPjxnCiAgICAgdHJhbnNmb3JtPSJtYXRyaXgoMS4zMzMzMzMzLDAsMCwtMS4zMzMzMzMzLDAsMTUxLjA0OTMzKSIKICAgICBpZD0iZzEwIj48ZwogICAgICAgaWQ9ImcxMiI+PGcKICAgICAgICAgY2xpcC1wYXRoPSJ1cmwoI2NsaXBQYXRoMTgpIgogICAgICAgICBpZD0iZzE0Ij48ZwogICAgICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg5LjQ5MjYsNzguNzc1KSIKICAgICAgICAgICBpZD0iZzIwIj48cGF0aAogICAgICAgICAgICAgaWQ9InBhdGgyMiIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiMzNzM1MzU7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmUiCiAgICAgICAgICAgICBkPSJtIDAsMCBoIC04LjU5MiBjIC0wLjIsMCAtMC4zNjIsLTAuMTYyIC0wLjM2MiwtMC4zNjIgdiAtMTguOTIyIGggLTE4LjY2MSB2IDE4LjkyMiBjIDAsMC4yIC0wLjE2MiwwLjM2MiAtMC4zNjIsMC4zNjIgaCAtOC41OTIgYyAtMC4xOTksMCAtMC4zNjIsLTAuMTYyIC0wLjM2MiwtMC4zNjIgdiAtNDQuNzQ1IGMgMCwtMC4yIDAuMTYzLC0wLjM2MiAwLjM2MiwtMC4zNjIgaCA4LjU5MiBjIDAuMiwwIDAuMzYyLDAuMTYyIDAuMzYyLDAuMzYyIHYgMTguOTIyIGggMTguNjYxIHYgLTE4LjkyMiBjIDAsLTAuMiAwLjE2MiwtMC4zNjIgMC4zNjIsLTAuMzYyIEggMCBjIDAuMiwwIDAuMzYyLDAuMTYyIDAuMzYyLDAuMzYyIFYgLTAuMzYyIEMgMC4zNjIsLTAuMTYyIDAuMiwwIDAsMCIgLz48L2c+PGcKICAgICAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxODIuODQzNSw3OC43NzUpIgogICAgICAgICAgIGlkPSJnMjQiPjxwYXRoCiAgICAgICAgICAgICBpZD0icGF0aDI2IgogICAgICAgICAgICAgc3R5bGU9ImZpbGw6IzM3MzUzNTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZSIKICAgICAgICAgICAgIGQ9Im0gMCwwIGggLTguNTkyIGMgLTAuMiwwIC0wLjM2MiwtMC4xNjIgLTAuMzYyLC0wLjM2MiB2IC0yOC42NzcgYyAwLC03LjI5MyAtMy42MSwtMTAuNDcgLTkuMzE1LC0xMC40NyAtNS43MDUsMCAtOS4zMTUsMy4xNzcgLTkuMzE1LDEwLjQ3IHYgMjguNjc3IGMgMCwwLjIgLTAuMTYyLDAuMzYyIC0wLjM2MiwwLjM2MiBoIC04LjU5MiBjIC0wLjE5OSwwIC0wLjM2MSwtMC4xNjIgLTAuMzYxLC0wLjM2MiBWIC0yOC4yMSBjIDAsLTExLjQxIDYuOTMyLC0xOC4xOTcgMTguNjMsLTE4LjE5NyAxMS42OTksMCAxOC42MzEsNi43ODcgMTguNjMxLDE4LjE5NyBWIC0wLjM2MiBDIDAuMzYyLC0wLjE2MiAwLjIsMCAwLDAiIC8+PC9nPjxnCiAgICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjc0LjQ3LDc4Ljc3NSkiCiAgICAgICAgICAgaWQ9ImcyOCI+PHBhdGgKICAgICAgICAgICAgIGlkPSJwYXRoMzAiCiAgICAgICAgICAgICBzdHlsZT0iZmlsbDojMzczNTM1O2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lIgogICAgICAgICAgICAgZD0ibSAwLDAgaCAtNDAuNDM3IGMgLTAuMiwwIC0wLjM2MiwtMC4xNjIgLTAuMzYyLC0wLjM2MiB2IC02LjE3IGMgMCwtMC4yIDAuMTYyLC0wLjM2MiAwLjM2MiwtMC4zNjIgaCAxNS41NjEgdiAtMzguMjEzIGMgMCwtMC4yIDAuMTYyLC0wLjM2MiAwLjM2MiwtMC4zNjIgaCA4LjU5MSBjIDAuMiwwIDAuMzYyLDAuMTYyIDAuMzYyLDAuMzYyIFYgLTYuODk0IEggMCBjIDAuMiwwIDAuMzYyLDAuMTYyIDAuMzYyLDAuMzYyIHYgNi4xNyBDIDAuMzYyLC0wLjE2MiAwLjIsMCAwLDAiIC8+PC9nPjxnCiAgICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzg0LjM2NSw0Ni4wMTU3KSIKICAgICAgICAgICBpZD0iZzMyIj48cGF0aAogICAgICAgICAgICAgaWQ9InBhdGgzNCIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiMzNzM1MzU7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmUiCiAgICAgICAgICAgICBkPSJtIDAsMCBjIC0zLjUwOSwwIC02LjM1NSwtMi44NDUgLTYuMzU1LC02LjM1NSB2IDAgYyAwLC0zLjUwOSAyLjg0NiwtNi4zNTUgNi4zNTUsLTYuMzU1IDMuNTEsMCA2LjM1NSwyLjg0NiA2LjM1NSw2LjM1NSB2IDAgQyA2LjM1NSwtMi44NDUgMy41MSwwIDAsMCIgLz48L2c+PGcKICAgICAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzOC4yNDE4LDQ2LjAxNTcpIgogICAgICAgICAgIGlkPSJnMzYiPjxwYXRoCiAgICAgICAgICAgICBpZD0icGF0aDM4IgogICAgICAgICAgICAgc3R5bGU9ImZpbGw6IzM3MzUzNTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZSIKICAgICAgICAgICAgIGQ9Im0gMCwwIGMgLTMuNTEsMCAtNi4zNTUsLTIuODQ1IC02LjM1NSwtNi4zNTUgdiAwIGMgMCwtMy41MDkgMi44NDUsLTYuMzU1IDYuMzU1LC02LjM1NSAzLjUwOSwwIDYuMzU1LDIuODQ2IDYuMzU1LDYuMzU1IHYgMCBDIDYuMzU1LC0yLjg0NSAzLjUwOSwwIDAsMCIgLz48L2c+PGcKICAgICAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NDEuMzEyMyw0Ni4wMTU3KSIKICAgICAgICAgICBpZD0iZzQwIj48cGF0aAogICAgICAgICAgICAgaWQ9InBhdGg0MiIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiMzNzM1MzU7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmUiCiAgICAgICAgICAgICBkPSJtIDAsMCBjIC0zLjUwOSwwIC02LjM1NSwtMi44NDUgLTYuMzU1LC02LjM1NSB2IDAgYyAwLC0zLjUwOSAyLjg0NiwtNi4zNTUgNi4zNTUsLTYuMzU1IDMuNTEsMCA2LjM1NSwyLjg0NiA2LjM1NSw2LjM1NSB2IDAgQyA2LjM1NSwtMi44NDUgMy41MSwwIDAsMCIgLz48L2c+PGcKICAgICAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MzAuNzg0LDc4Ljc3NSkiCiAgICAgICAgICAgaWQ9Imc0NCI+PHBhdGgKICAgICAgICAgICAgIGlkPSJwYXRoNDYiCiAgICAgICAgICAgICBzdHlsZT0iZmlsbDojMzczNTM1O2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lIgogICAgICAgICAgICAgZD0ibSAwLDAgaCAtMzAuNjE2IGMgLTAuMiwwIC0wLjM2MiwtMC4xNjIgLTAuMzYyLC0wLjM2MiB2IC02LjE3IGMgMCwtMC4yIDAuMTYyLC0wLjM2MiAwLjM2MiwtMC4zNjIgaCAxMC42NSB2IC0zMS42ODIgaCAtMTAuNjUgYyAtMC4yLDAgLTAuMzYyLC0wLjE2MiAtMC4zNjIsLTAuMzYyIHYgLTYuMTY5IGMgMCwtMC4yIDAuMTYyLC0wLjM2MiAwLjM2MiwtMC4zNjIgSCAwIGMgMC4yLDAgMC4zNjIsMC4xNjIgMC4zNjIsMC4zNjIgdiA2LjE2OSBjIDAsMC4yIC0wLjE2MiwwLjM2MiAtMC4zNjIsMC4zNjIgaCAtMTAuNjUgbCAwLjAzNSwzMS42ODIgSCAwIGMgMC4yLDAgMC4zNjIsMC4xNjIgMC4zNjIsMC4zNjIgdiA2LjE3IEMgMC4zNjIsLTAuMTYyIDAuMiwwIDAsMCIgLz48L2c+PGcKICAgICAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMDUuODg3MSw0MS44NzcpIgogICAgICAgICAgIGlkPSJnNDgiPjxwYXRoCiAgICAgICAgICAgICBpZD0icGF0aDUwIgogICAgICAgICAgICAgc3R5bGU9ImZpbGw6IzM3MzUzNTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZSIKICAgICAgICAgICAgIGQ9Im0gMCwwIGMgLTEuOTUxLC0xLjc5NSAtNC40MDcsLTIuNTkzIC03LjIyNSwtMi41OTMgLTIuODE3LDAgLTUuMjc0LDAuNzk4IC03LjIyNCwyLjU5MyAtMy41NDEsMy4yNTggLTMuNTQxLDEwLjI0IC0zLjU0MSwxNC4xNjMgMCwzLjkyNCAwLDEwLjkwNiAzLjU0MSwxNC4xNjQgMS45NSwxLjc5NSA0LjQwNywyLjU5MyA3LjIyNCwyLjU5MyAyLjgxOCwwIDUuMjc0LC0wLjc5OCA3LjIyNSwtMi41OTMgQyAzLjU0LDI1LjA2OSAzLjU0LDE4LjA4NyAzLjU0LDE0LjE2MyAzLjU0LDEwLjI0IDMuNTQsMy4yNTggMCwwIG0gLTcuMjI1LDM3LjgzNyBjIC01LjE2NSwwIC05LjgyOCwtMS40MTUgLTEzLjU1OSwtNC43NiAtNS41OTUsLTUuMDE4IC02LjUyOCwtMTEuNjQ0IC02LjUyOCwtMTguOTE0IDAsLTcuMjY5IDAuOTMzLC0xMy44OTQgNi41MjgsLTE4LjkxMiAzLjczMSwtMy4zNDUgOC4zOTQsLTQuNzYxIDEzLjU1OSwtNC43NjEgNS4xNjYsMCA5LjgyOCwxLjQxNiAxMy41NTksNC43NjEgNS41OTYsNS4wMTggNi41MjgsMTEuNjQzIDYuNTI4LDE4LjkxMiAwLDcuMjcgLTAuOTMyLDEzLjg5NiAtNi41MjgsMTguOTE0IC0zLjczMSwzLjM0NSAtOC4zOTMsNC43NiAtMTMuNTU5LDQuNzYiIC8+PC9nPjxnCiAgICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTI0Ljk3NzQsNDEuODc3KSIKICAgICAgICAgICBpZD0iZzUyIj48cGF0aAogICAgICAgICAgICAgaWQ9InBhdGg1NCIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiMzNzM1MzU7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmUiCiAgICAgICAgICAgICBkPSJtIDAsMCBjIC0xLjk1MSwtMS43OTUgLTQuNDA3LC0yLjU5MyAtNy4yMjUsLTIuNTkzIC0yLjgxNywwIC01LjI3NCwwLjc5OCAtNy4yMjQsMi41OTMgLTMuNTQxLDMuMjU4IC0zLjU0MSwxMC4yNCAtMy41NDEsMTQuMTYzIDAsMy45MjQgMCwxMC45MDYgMy41NDEsMTQuMTY0IDEuOTUsMS43OTUgNC40MDcsMi41OTMgNy4yMjQsMi41OTMgMi44MTgsMCA1LjI3NCwtMC43OTggNy4yMjUsLTIuNTkzIEMgMy41NCwyNS4wNjkgMy41NCwxOC4wODcgMy41NCwxNC4xNjMgMy41NCwxMC4yNCAzLjU0LDMuMjU4IDAsMCBtIC03LjIyNSwzNy44MzcgYyAtNS4xNjUsMCAtOS44MjgsLTEuNDE1IC0xMy41NTksLTQuNzYgLTUuNTk1LC01LjAxOCAtNi41MjgsLTExLjY0NCAtNi41MjgsLTE4LjkxNCAwLC03LjI2OSAwLjkzMywtMTMuODk0IDYuNTI4LC0xOC45MTIgMy43MzEsLTMuMzQ1IDguMzk0LC00Ljc2MSAxMy41NTksLTQuNzYxIDUuMTY2LDAgOS44MjksMS40MTYgMTMuNTU5LDQuNzYxIDUuNTk2LDUuMDE4IDYuNTI4LDExLjY0MyA2LjUyOCwxOC45MTIgMCw3LjI3IC0wLjkzMiwxMy44OTYgLTYuNTI4LDE4LjkxNCAtMy43MywzLjM0NSAtOC4zOTMsNC43NiAtMTMuNTU5LDQuNzYiIC8+PC9nPjxnCiAgICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjA5LjkyNSw3My4xMjQxKSIKICAgICAgICAgICBpZD0iZzU2Ij48cGF0aAogICAgICAgICAgICAgaWQ9InBhdGg1OCIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiMzNzM1MzU7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmUiCiAgICAgICAgICAgICBkPSJtIDAsMCBjIDYuMTU1LC0wLjIzNiA5LjEzNCwtMy42ODggOS4xMzQsLTcuNTQ2IGggOS4zMzkgYyAwLDguODc0IC03LjY0MiwxNC40NCAtMTguMzI5LDE0LjQ0IC0xMS42OTgsMCAtMTkuMTA1LC02LjQ5MiAtMTguNTQ1LC0xNC4zMSAwLjQ1NCwtNi4zMjYgNS4zMDEsLTkuNzc2IDEzLjcwOSwtMTEuOTEgbCAtMC4wMDIsLTAuMDA4IDcuMTUxLC0xLjgwNiBjIDQuNTgyLC0xLjE2IDYuMjkzLC0yLjcxMyA2LjY1NiwtNS40NzYgMC42NDksLTQuOTQzIC0zLjc1MywtNy40NSAtOS4wNywtNy4yNDcgLTYuMTU1LDAuMjM3IC05LjEzNCwzLjY4OSAtOS4xMzQsNy41NDYgaCAtOS4zMzkgYyAwLC04Ljg3MyA3LjY0MiwtMTQuNDQgMTguMzI5LC0xNC40NCAxMS42OTksMCAxOS4xMDUsNi40OTMgMTguNTQ1LDE0LjMxMSAtMC40NTQsNi4zMjUgLTUuMzAxLDkuNzA2IC0xMy43MDksMTEuODM3IGwgMC4wMDIsMC4wMDggLTcuMTUsMS44MDYgYyAtNC41ODIsMS4xNTkgLTYuMjk0LDIuNzg2IC02LjY1Nyw1LjU0OSBDIC05LjcxOSwtMi4zMDQgLTUuMzE3LDAuMjA0IDAsMCIgLz48L2c+PGcKICAgICAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNjguNTAzNyw3OC43NzUzKSIKICAgICAgICAgICBpZD0iZzYwIj48cGF0aAogICAgICAgICAgICAgaWQ9InBhdGg2MiIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiMzNzM1MzU7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmUiCiAgICAgICAgICAgICBkPSJtIDAsMCBoIC04LjU4NyBjIC0wLjIsMCAtMC4zNjIsLTAuMTYyIC0wLjM2MiwtMC4zNjIgdiAtMzguMjEzIGggLTEuNjQ0IEwgLTI1LjUwNSwtMC42ODIgQyAtMjUuNjY3LC0wLjI3MSAtMjYuMDY0LDAgLTI2LjUwNiwwIGggLTE0LjU1NiBjIC0wLjIsMCAtMC4zNjIsLTAuMTYyIC0wLjM2MiwtMC4zNjIgdiAtNDQuNzQ1IGMgMCwtMC4yIDAuMTYyLC0wLjM2MiAwLjM2MiwtMC4zNjIgaCA4LjU4NiBjIDAuMiwwIDAuMzYyLDAuMTYyIDAuMzYyLDAuMzYyIHYgMzguMjEzIGggMS42NDUgbCAxNC45MTIsLTM3Ljg5MyBjIDAuMTYyLC0wLjQxMiAwLjU1OCwtMC42ODIgMS4wMDEsLTAuNjgyIEggMCBjIDAuMiwwIDAuMzYyLDAuMTYyIDAuMzYyLDAuMzYyIFYgLTAuMzYyIEMgMC4zNjIsLTAuMTYyIDAuMiwwIDAsMCIgLz48L2c+PGcKICAgICAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0ODIuMTI1MSw3OC43NzUzKSIKICAgICAgICAgICBpZD0iZzY0Ij48cGF0aAogICAgICAgICAgICAgaWQ9InBhdGg2NiIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiMzNzM1MzU7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmUiCiAgICAgICAgICAgICBkPSJtIDAsMCBoIC04LjU4NyBjIC0wLjIsMCAtMC4zNjIsLTAuMTYyIC0wLjM2MiwtMC4zNjIgdiAtMzguMjEzIGggLTEuNjQ0IEwgLTI1LjUwNSwtMC42ODIgQyAtMjUuNjY3LC0wLjI3MSAtMjYuMDY0LDAgLTI2LjUwNiwwIGggLTE0LjU1NiBjIC0wLjIsMCAtMC4zNjIsLTAuMTYyIC0wLjM2MiwtMC4zNjIgdiAtNDQuNzQ1IGMgMCwtMC4yIDAuMTYyLC0wLjM2MiAwLjM2MiwtMC4zNjIgaCA4LjU4NiBjIDAuMiwwIDAuMzYyLDAuMTYyIDAuMzYyLDAuMzYyIHYgMzguMjEzIGggMS42NDUgbCAxNC45MTIsLTM3Ljg5MyBjIDAuMTYyLC0wLjQxMiAwLjU1OSwtMC42ODIgMS4wMDEsLTAuNjgyIEggMCBjIDAuMiwwIDAuMzYyLDAuMTYyIDAuMzYyLDAuMzYyIFYgLTAuMzYyIEMgMC4zNjIsLTAuMTYyIDAuMiwwIDAsMCIgLz48L2c+PGcKICAgICAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MTAuMjQ4OCw3Mi43OTc1KSIKICAgICAgICAgICBpZD0iZzY4Ij48cGF0aAogICAgICAgICAgICAgaWQ9InBhdGg3MCIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiMzNzM1MzU7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmUiCiAgICAgICAgICAgICBkPSJtIDAsMCBjIDIuNzA0LDAgNS4wNjEsLTAuNzk4IDYuOTMyLC0yLjU5MyAyLjEwNCwtMi4wMTggMi45LC01LjQ2MSAzLjIwNSwtOC43MjUgMC4wMTQsLTAuMTUzIDAuMTQyLC0wLjI2OSAwLjI5NSwtMC4yNjkgaCA4LjkzNyBjIDAuMTcyLDAgMC4zMSwwLjE0NiAwLjI5OSwwLjMxOSAtMC4zMzcsNS4wOTYgLTEuNTIzLDkuNzAzIC01LjY3MiwxMy40MjQgLTMuNzMxLDMuMzQ1IC04LjM5NCw0Ljc2MSAtMTMuNTYsNC43NjEgLTUuMTY1LDAgLTkuODI4LC0xLjQxNiAtMTMuNTU4LC00Ljc2MSAtNS41OTYsLTUuMDE4IC02LjUyOSwtMTEuNjQ0IC02LjUyOSwtMTguOTEzIDAsLTcuMjY5IDAuOTMzLC0xMy44OTUgNi41MjksLTE4LjkxMyAzLjczLC0zLjM0NSA4LjM5MywtNC43NiAxMy41NTgsLTQuNzYgNS4xNjYsMCA5LjgyOSwxLjQxNSAxMy41Niw0Ljc2IDQuMTUsMy43MjIgNS4zMzUsOC4zMjggNS42NzIsMTMuNDI1IDAuMDExLDAuMTcyIC0wLjEyNywwLjMxOSAtMC4yOTksMC4zMTkgaCAtOC45MzcgYyAtMC4xNTMsMCAtMC4yODEsLTAuMTE3IC0wLjI5NSwtMC4yNyBDIDkuODMyLC0yNS40NTkgOS4wMzYsLTI4LjkwMiA2LjkzMiwtMzAuOTIgNS4wNjEsLTMyLjcxNiAyLjcwNCwtMzMuNTE0IDAsLTMzLjUxNCBjIC0yLjcwMywwIC01LjA2LDAuNzk4IC02LjkzMiwyLjU5NCAtMy4zOTYsMy4yNTggLTMuMzk2LDEwLjI0IC0zLjM5NiwxNC4xNjMgMCwzLjkyMyAwLDEwLjkwNSAzLjM5NiwxNC4xNjQgQyAtNS4wNiwtMC43OTggLTIuNzAzLDAgMCwwIiAvPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" alt="Houston inc. logo"/></div></div></a></div><div class="col-5 col-5--mobile order-2--mobile order-2--tablet footer__navigation element--flex"><div class="footer__navigation-link-container"><a class="footer__navigation-link nav-item-hover" style="margin-left:4.5rem" href="/about">About course</a><a class="footer__navigation-link nav-item-hover" style="margin-left:4.5rem" href="/#course-contents">Course contents</a><a class="footer__navigation-link nav-item-hover" style="margin-left:4.5rem" href="/part0/syllabus">Syllabus</a><a class="footer__navigation-link nav-item-hover" style="margin-left:4.5rem" href="/faq">FAQ</a><a class="footer__navigation-link nav-item-hover" style="margin-left:4.5rem" href="/thanks">Acknowledgements</a></div></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/part4/testing_the_backend";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-dd357ea592e758b99643.js"],"component---src-pages-404-js":["/component---src-pages-404-js-c2f29ac7fac2c72c0da3.js"],"component---src-pages-about-js":["/component---src-pages-about-js-7307f3695bb2b86f6cf2.js"],"component---src-pages-challenge-js":["/component---src-pages-challenge-js-b67839c8c76875b8c258.js"],"component---src-pages-faq-js":["/component---src-pages-faq-js-ad75067a9c68fa65bd52.js"],"component---src-pages-index-js":["/component---src-pages-index-js-626b3e6b7dd7bd4a23bf.js"],"component---src-pages-search-js":["/component---src-pages-search-js-d396b006966319872075.js"],"component---src-pages-thanks-js":["/component---src-pages-thanks-js-3d7107307a8b74daf1db.js"],"component---src-templates-content-template-js":["/component---src-templates-content-template-js-d6ac83f8ee71944e42d9.js"],"component---src-templates-part-intro-template-js":["/component---src-templates-part-intro-template-js-47d3412e0caa8063cf8d.js"]};/*]]>*/</script><script src="/webpack-runtime-8e24bcdbf9da631062c7.js" async=""></script><script src="/framework-8cb3270495e919798e3b.js" async=""></script><script src="/commons-04451b38a7b232ddc46f.js" async=""></script><script src="/bd3b11e4ab29109ed2b86501ebb9c0833718e029-306c9da09477fa9d50eb.js" async=""></script><script src="/aa63343c7cf9d92e00ea1a246d5d0f4f54465620-7e7bd772c5bbcf0f4851.js" async=""></script><script src="/styles-89fd2ae28bdf06750a71.js" async=""></script><script src="/e4354a253f92224f15d9052b835f37a9cce77cf7-4624078180071cfa198f.js" async=""></script><script src="/component---src-templates-content-template-js-d6ac83f8ee71944e42d9.js" async=""></script><script src="/app-dd357ea592e758b99643.js" async=""></script><script src="/7dd12e78b77ad11302d3983d1a97a16cf64ad671-91cf5431cb3e1fc76518.js" async=""></script></body></html>